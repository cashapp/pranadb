--local only;
-- This tests all the basic functions and operators we provide;
--create topic testtopic;
use test;
0 rows returned
create source test_source_1(
    col0 bigint,
    col1 tinyint,
    col2 int,
    col3 double,
    col4 decimal(10, 2),
    col5 varchar,
    col6 timestamp(6),
    primary key (col0)
) with (
    brokername = "testbroker",
    topicname = "testtopic",
    headerencoding = "json",
    keyencoding = "json",
    valueencoding = "json",
    columnselectors = (
        meta("key").k0,
        v1,
        v2,
        v3,
        v4,
        v5,
        v6
    )
);
0 rows returned

--load data dataset_1;

-- EQ;
select * from test_source_1 where col0 = 3;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 3                    | 30   | 3000        | 3234.432100  | 32345678.99  | null         | 2020-01-03 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from test_source_1 where col1 = 40;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 4                    | 40   | 4000        | null         | 42345678.99  | str4         | 2020-01-04 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from test_source_1 where col2 = 5000;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 5                    | 50   | 5000        | 5234.432100  | 52345678.99  | str5         | 2020-01-05 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from test_source_1 where col3 = 3234.4321;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 3                    | 30   | 3000        | 3234.432100  | 32345678.99  | null         | 2020-01-03 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from test_source_1 where col4 = 22345678.99;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 2                    | 20   | 2000        | 2234.432100  | 22345678.99  | str2         | 2020-01-02 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from test_source_1 where col5 = 'str9';
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 9                    | 90   | 9000        | 9234.432100  | 92345678.99  | str9         | 2020-01-09 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from test_source_1 where col6 = '2020-01-04 01:00:00.123456';
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 4                    | 40   | 4000        | null         | 42345678.99  | str4         | 2020-01-04 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
1 rows returned

-- GE;
select * from test_source_1 where col0 >= 5 order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 5                    | 50   | 5000        | 5234.432100  | 52345678.99  | str5         | 2020-01-05 01:00:00.123456 |
| 6                    | null | 6000        | 6234.432100  | 62345678.99  | str6         | 2020-01-06 01:00:00.123456 |
| 7                    | 70   | 7000        | 7234.432100  | null         | str7         | 2020-01-07 01:00:00.123456 |
| 8                    | 80   | null        | 8234.432100  | 82345678.99  | str8         | null                       |
| 9                    | 90   | 9000        | 9234.432100  | 92345678.99  | str9         | 2020-01-09 01:00:00.123456 |
| 10                   | 100  | 10000       | 10234.432100 | 93345678.99  | str10        | 2020-01-10 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
6 rows returned
select * from test_source_1 where col1 >= 40 order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 4                    | 40   | 4000        | null         | 42345678.99  | str4         | 2020-01-04 01:00:00.123456 |
| 5                    | 50   | 5000        | 5234.432100  | 52345678.99  | str5         | 2020-01-05 01:00:00.123456 |
| 7                    | 70   | 7000        | 7234.432100  | null         | str7         | 2020-01-07 01:00:00.123456 |
| 8                    | 80   | null        | 8234.432100  | 82345678.99  | str8         | null                       |
| 9                    | 90   | 9000        | 9234.432100  | 92345678.99  | str9         | 2020-01-09 01:00:00.123456 |
| 10                   | 100  | 10000       | 10234.432100 | 93345678.99  | str10        | 2020-01-10 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
6 rows returned
select * from test_source_1 where col2 >= 5000 order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 5                    | 50   | 5000        | 5234.432100  | 52345678.99  | str5         | 2020-01-05 01:00:00.123456 |
| 6                    | null | 6000        | 6234.432100  | 62345678.99  | str6         | 2020-01-06 01:00:00.123456 |
| 7                    | 70   | 7000        | 7234.432100  | null         | str7         | 2020-01-07 01:00:00.123456 |
| 9                    | 90   | 9000        | 9234.432100  | 92345678.99  | str9         | 2020-01-09 01:00:00.123456 |
| 10                   | 100  | 10000       | 10234.432100 | 93345678.99  | str10        | 2020-01-10 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
5 rows returned
select * from test_source_1 where col3 >= 3234.4321 order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 3                    | 30   | 3000        | 3234.432100  | 32345678.99  | null         | 2020-01-03 01:00:00.123456 |
| 5                    | 50   | 5000        | 5234.432100  | 52345678.99  | str5         | 2020-01-05 01:00:00.123456 |
| 6                    | null | 6000        | 6234.432100  | 62345678.99  | str6         | 2020-01-06 01:00:00.123456 |
| 7                    | 70   | 7000        | 7234.432100  | null         | str7         | 2020-01-07 01:00:00.123456 |
| 8                    | 80   | null        | 8234.432100  | 82345678.99  | str8         | null                       |
| 9                    | 90   | 9000        | 9234.432100  | 92345678.99  | str9         | 2020-01-09 01:00:00.123456 |
| 10                   | 100  | 10000       | 10234.432100 | 93345678.99  | str10        | 2020-01-10 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
7 rows returned
select * from test_source_1 where col4 >= 22345678.99 order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 2                    | 20   | 2000        | 2234.432100  | 22345678.99  | str2         | 2020-01-02 01:00:00.123456 |
| 3                    | 30   | 3000        | 3234.432100  | 32345678.99  | null         | 2020-01-03 01:00:00.123456 |
| 4                    | 40   | 4000        | null         | 42345678.99  | str4         | 2020-01-04 01:00:00.123456 |
| 5                    | 50   | 5000        | 5234.432100  | 52345678.99  | str5         | 2020-01-05 01:00:00.123456 |
| 6                    | null | 6000        | 6234.432100  | 62345678.99  | str6         | 2020-01-06 01:00:00.123456 |
| 8                    | 80   | null        | 8234.432100  | 82345678.99  | str8         | null                       |
| 9                    | 90   | 9000        | 9234.432100  | 92345678.99  | str9         | 2020-01-09 01:00:00.123456 |
| 10                   | 100  | 10000       | 10234.432100 | 93345678.99  | str10        | 2020-01-10 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
8 rows returned
select * from test_source_1 where col5 >= 'str9' order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 9                    | 90   | 9000        | 9234.432100  | 92345678.99  | str9         | 2020-01-09 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from test_source_1 where col6 >= '2020-01-04 01:00:00.123456' order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 4                    | 40   | 4000        | null         | 42345678.99  | str4         | 2020-01-04 01:00:00.123456 |
| 5                    | 50   | 5000        | 5234.432100  | 52345678.99  | str5         | 2020-01-05 01:00:00.123456 |
| 6                    | null | 6000        | 6234.432100  | 62345678.99  | str6         | 2020-01-06 01:00:00.123456 |
| 7                    | 70   | 7000        | 7234.432100  | null         | str7         | 2020-01-07 01:00:00.123456 |
| 9                    | 90   | 9000        | 9234.432100  | 92345678.99  | str9         | 2020-01-09 01:00:00.123456 |
| 10                   | 100  | 10000       | 10234.432100 | 93345678.99  | str10        | 2020-01-10 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
6 rows returned

-- GT;
select * from test_source_1 where col0 > 5 order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 6                    | null | 6000        | 6234.432100  | 62345678.99  | str6         | 2020-01-06 01:00:00.123456 |
| 7                    | 70   | 7000        | 7234.432100  | null         | str7         | 2020-01-07 01:00:00.123456 |
| 8                    | 80   | null        | 8234.432100  | 82345678.99  | str8         | null                       |
| 9                    | 90   | 9000        | 9234.432100  | 92345678.99  | str9         | 2020-01-09 01:00:00.123456 |
| 10                   | 100  | 10000       | 10234.432100 | 93345678.99  | str10        | 2020-01-10 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
5 rows returned
select * from test_source_1 where col1 > 40 order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 5                    | 50   | 5000        | 5234.432100  | 52345678.99  | str5         | 2020-01-05 01:00:00.123456 |
| 7                    | 70   | 7000        | 7234.432100  | null         | str7         | 2020-01-07 01:00:00.123456 |
| 8                    | 80   | null        | 8234.432100  | 82345678.99  | str8         | null                       |
| 9                    | 90   | 9000        | 9234.432100  | 92345678.99  | str9         | 2020-01-09 01:00:00.123456 |
| 10                   | 100  | 10000       | 10234.432100 | 93345678.99  | str10        | 2020-01-10 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
5 rows returned
select * from test_source_1 where col2 > 5000 order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 6                    | null | 6000        | 6234.432100  | 62345678.99  | str6         | 2020-01-06 01:00:00.123456 |
| 7                    | 70   | 7000        | 7234.432100  | null         | str7         | 2020-01-07 01:00:00.123456 |
| 9                    | 90   | 9000        | 9234.432100  | 92345678.99  | str9         | 2020-01-09 01:00:00.123456 |
| 10                   | 100  | 10000       | 10234.432100 | 93345678.99  | str10        | 2020-01-10 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
4 rows returned
select * from test_source_1 where col3 > 3234.4321 order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 5                    | 50   | 5000        | 5234.432100  | 52345678.99  | str5         | 2020-01-05 01:00:00.123456 |
| 6                    | null | 6000        | 6234.432100  | 62345678.99  | str6         | 2020-01-06 01:00:00.123456 |
| 7                    | 70   | 7000        | 7234.432100  | null         | str7         | 2020-01-07 01:00:00.123456 |
| 8                    | 80   | null        | 8234.432100  | 82345678.99  | str8         | null                       |
| 9                    | 90   | 9000        | 9234.432100  | 92345678.99  | str9         | 2020-01-09 01:00:00.123456 |
| 10                   | 100  | 10000       | 10234.432100 | 93345678.99  | str10        | 2020-01-10 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
6 rows returned
select * from test_source_1 where col4 > 22345678.99 order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 3                    | 30   | 3000        | 3234.432100  | 32345678.99  | null         | 2020-01-03 01:00:00.123456 |
| 4                    | 40   | 4000        | null         | 42345678.99  | str4         | 2020-01-04 01:00:00.123456 |
| 5                    | 50   | 5000        | 5234.432100  | 52345678.99  | str5         | 2020-01-05 01:00:00.123456 |
| 6                    | null | 6000        | 6234.432100  | 62345678.99  | str6         | 2020-01-06 01:00:00.123456 |
| 8                    | 80   | null        | 8234.432100  | 82345678.99  | str8         | null                       |
| 9                    | 90   | 9000        | 9234.432100  | 92345678.99  | str9         | 2020-01-09 01:00:00.123456 |
| 10                   | 100  | 10000       | 10234.432100 | 93345678.99  | str10        | 2020-01-10 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
7 rows returned
select * from test_source_1 where col5 > 'str9' order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
0 rows returned
select * from test_source_1 where col6 > '2020-01-04 01:00:00.123456' order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 5                    | 50   | 5000        | 5234.432100  | 52345678.99  | str5         | 2020-01-05 01:00:00.123456 |
| 6                    | null | 6000        | 6234.432100  | 62345678.99  | str6         | 2020-01-06 01:00:00.123456 |
| 7                    | 70   | 7000        | 7234.432100  | null         | str7         | 2020-01-07 01:00:00.123456 |
| 9                    | 90   | 9000        | 9234.432100  | 92345678.99  | str9         | 2020-01-09 01:00:00.123456 |
| 10                   | 100  | 10000       | 10234.432100 | 93345678.99  | str10        | 2020-01-10 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
5 rows returned

-- LE;
select * from test_source_1 where col0 <= 5 order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 1                    | 10   | 1000        | 1234.432100  | 12345678.99  | str1         | 2020-01-01 01:00:00.123456 |
| 2                    | 20   | 2000        | 2234.432100  | 22345678.99  | str2         | 2020-01-02 01:00:00.123456 |
| 3                    | 30   | 3000        | 3234.432100  | 32345678.99  | null         | 2020-01-03 01:00:00.123456 |
| 4                    | 40   | 4000        | null         | 42345678.99  | str4         | 2020-01-04 01:00:00.123456 |
| 5                    | 50   | 5000        | 5234.432100  | 52345678.99  | str5         | 2020-01-05 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
5 rows returned
select * from test_source_1 where col1 <= 40 order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 1                    | 10   | 1000        | 1234.432100  | 12345678.99  | str1         | 2020-01-01 01:00:00.123456 |
| 2                    | 20   | 2000        | 2234.432100  | 22345678.99  | str2         | 2020-01-02 01:00:00.123456 |
| 3                    | 30   | 3000        | 3234.432100  | 32345678.99  | null         | 2020-01-03 01:00:00.123456 |
| 4                    | 40   | 4000        | null         | 42345678.99  | str4         | 2020-01-04 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
4 rows returned
select * from test_source_1 where col2 <= 5000 order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 1                    | 10   | 1000        | 1234.432100  | 12345678.99  | str1         | 2020-01-01 01:00:00.123456 |
| 2                    | 20   | 2000        | 2234.432100  | 22345678.99  | str2         | 2020-01-02 01:00:00.123456 |
| 3                    | 30   | 3000        | 3234.432100  | 32345678.99  | null         | 2020-01-03 01:00:00.123456 |
| 4                    | 40   | 4000        | null         | 42345678.99  | str4         | 2020-01-04 01:00:00.123456 |
| 5                    | 50   | 5000        | 5234.432100  | 52345678.99  | str5         | 2020-01-05 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
5 rows returned
select * from test_source_1 where col3 <= 3234.4321 order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 1                    | 10   | 1000        | 1234.432100  | 12345678.99  | str1         | 2020-01-01 01:00:00.123456 |
| 2                    | 20   | 2000        | 2234.432100  | 22345678.99  | str2         | 2020-01-02 01:00:00.123456 |
| 3                    | 30   | 3000        | 3234.432100  | 32345678.99  | null         | 2020-01-03 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
3 rows returned
select * from test_source_1 where col4 <= 22345678.99 order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 1                    | 10   | 1000        | 1234.432100  | 12345678.99  | str1         | 2020-01-01 01:00:00.123456 |
| 2                    | 20   | 2000        | 2234.432100  | 22345678.99  | str2         | 2020-01-02 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
2 rows returned
select * from test_source_1 where col5 <= 'str7' order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 1                    | 10   | 1000        | 1234.432100  | 12345678.99  | str1         | 2020-01-01 01:00:00.123456 |
| 2                    | 20   | 2000        | 2234.432100  | 22345678.99  | str2         | 2020-01-02 01:00:00.123456 |
| 4                    | 40   | 4000        | null         | 42345678.99  | str4         | 2020-01-04 01:00:00.123456 |
| 5                    | 50   | 5000        | 5234.432100  | 52345678.99  | str5         | 2020-01-05 01:00:00.123456 |
| 6                    | null | 6000        | 6234.432100  | 62345678.99  | str6         | 2020-01-06 01:00:00.123456 |
| 7                    | 70   | 7000        | 7234.432100  | null         | str7         | 2020-01-07 01:00:00.123456 |
| 10                   | 100  | 10000       | 10234.432100 | 93345678.99  | str10        | 2020-01-10 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
7 rows returned
select * from test_source_1 where col6 <= '2020-01-04 01:00:00.123456' order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 1                    | 10   | 1000        | 1234.432100  | 12345678.99  | str1         | 2020-01-01 01:00:00.123456 |
| 2                    | 20   | 2000        | 2234.432100  | 22345678.99  | str2         | 2020-01-02 01:00:00.123456 |
| 3                    | 30   | 3000        | 3234.432100  | 32345678.99  | null         | 2020-01-03 01:00:00.123456 |
| 4                    | 40   | 4000        | null         | 42345678.99  | str4         | 2020-01-04 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
4 rows returned

-- LT;
select * from test_source_1 where col0 < 5 order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 1                    | 10   | 1000        | 1234.432100  | 12345678.99  | str1         | 2020-01-01 01:00:00.123456 |
| 2                    | 20   | 2000        | 2234.432100  | 22345678.99  | str2         | 2020-01-02 01:00:00.123456 |
| 3                    | 30   | 3000        | 3234.432100  | 32345678.99  | null         | 2020-01-03 01:00:00.123456 |
| 4                    | 40   | 4000        | null         | 42345678.99  | str4         | 2020-01-04 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
4 rows returned
select * from test_source_1 where col1 < 40 order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 1                    | 10   | 1000        | 1234.432100  | 12345678.99  | str1         | 2020-01-01 01:00:00.123456 |
| 2                    | 20   | 2000        | 2234.432100  | 22345678.99  | str2         | 2020-01-02 01:00:00.123456 |
| 3                    | 30   | 3000        | 3234.432100  | 32345678.99  | null         | 2020-01-03 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
3 rows returned
select * from test_source_1 where col2 < 5000 order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 1                    | 10   | 1000        | 1234.432100  | 12345678.99  | str1         | 2020-01-01 01:00:00.123456 |
| 2                    | 20   | 2000        | 2234.432100  | 22345678.99  | str2         | 2020-01-02 01:00:00.123456 |
| 3                    | 30   | 3000        | 3234.432100  | 32345678.99  | null         | 2020-01-03 01:00:00.123456 |
| 4                    | 40   | 4000        | null         | 42345678.99  | str4         | 2020-01-04 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
4 rows returned
select * from test_source_1 where col3 < 3234.4321 order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 1                    | 10   | 1000        | 1234.432100  | 12345678.99  | str1         | 2020-01-01 01:00:00.123456 |
| 2                    | 20   | 2000        | 2234.432100  | 22345678.99  | str2         | 2020-01-02 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
2 rows returned
select * from test_source_1 where col4 < 22345678.99 order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 1                    | 10   | 1000        | 1234.432100  | 12345678.99  | str1         | 2020-01-01 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from test_source_1 where col5 < 'str7' order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 1                    | 10   | 1000        | 1234.432100  | 12345678.99  | str1         | 2020-01-01 01:00:00.123456 |
| 2                    | 20   | 2000        | 2234.432100  | 22345678.99  | str2         | 2020-01-02 01:00:00.123456 |
| 4                    | 40   | 4000        | null         | 42345678.99  | str4         | 2020-01-04 01:00:00.123456 |
| 5                    | 50   | 5000        | 5234.432100  | 52345678.99  | str5         | 2020-01-05 01:00:00.123456 |
| 6                    | null | 6000        | 6234.432100  | 62345678.99  | str6         | 2020-01-06 01:00:00.123456 |
| 10                   | 100  | 10000       | 10234.432100 | 93345678.99  | str10        | 2020-01-10 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
6 rows returned
select * from test_source_1 where col6 < '2020-01-04 01:00:00.123456' order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 1                    | 10   | 1000        | 1234.432100  | 12345678.99  | str1         | 2020-01-01 01:00:00.123456 |
| 2                    | 20   | 2000        | 2234.432100  | 22345678.99  | str2         | 2020-01-02 01:00:00.123456 |
| 3                    | 30   | 3000        | 3234.432100  | 32345678.99  | null         | 2020-01-03 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
3 rows returned

-- NE;
select * from test_source_1 where col0 <> 5 order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 1                    | 10   | 1000        | 1234.432100  | 12345678.99  | str1         | 2020-01-01 01:00:00.123456 |
| 2                    | 20   | 2000        | 2234.432100  | 22345678.99  | str2         | 2020-01-02 01:00:00.123456 |
| 3                    | 30   | 3000        | 3234.432100  | 32345678.99  | null         | 2020-01-03 01:00:00.123456 |
| 4                    | 40   | 4000        | null         | 42345678.99  | str4         | 2020-01-04 01:00:00.123456 |
| 6                    | null | 6000        | 6234.432100  | 62345678.99  | str6         | 2020-01-06 01:00:00.123456 |
| 7                    | 70   | 7000        | 7234.432100  | null         | str7         | 2020-01-07 01:00:00.123456 |
| 8                    | 80   | null        | 8234.432100  | 82345678.99  | str8         | null                       |
| 9                    | 90   | 9000        | 9234.432100  | 92345678.99  | str9         | 2020-01-09 01:00:00.123456 |
| 10                   | 100  | 10000       | 10234.432100 | 93345678.99  | str10        | 2020-01-10 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
9 rows returned
select * from test_source_1 where col1 <> 40 order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 1                    | 10   | 1000        | 1234.432100  | 12345678.99  | str1         | 2020-01-01 01:00:00.123456 |
| 2                    | 20   | 2000        | 2234.432100  | 22345678.99  | str2         | 2020-01-02 01:00:00.123456 |
| 3                    | 30   | 3000        | 3234.432100  | 32345678.99  | null         | 2020-01-03 01:00:00.123456 |
| 5                    | 50   | 5000        | 5234.432100  | 52345678.99  | str5         | 2020-01-05 01:00:00.123456 |
| 7                    | 70   | 7000        | 7234.432100  | null         | str7         | 2020-01-07 01:00:00.123456 |
| 8                    | 80   | null        | 8234.432100  | 82345678.99  | str8         | null                       |
| 9                    | 90   | 9000        | 9234.432100  | 92345678.99  | str9         | 2020-01-09 01:00:00.123456 |
| 10                   | 100  | 10000       | 10234.432100 | 93345678.99  | str10        | 2020-01-10 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
8 rows returned
select * from test_source_1 where col2 <> 5000 order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 1                    | 10   | 1000        | 1234.432100  | 12345678.99  | str1         | 2020-01-01 01:00:00.123456 |
| 2                    | 20   | 2000        | 2234.432100  | 22345678.99  | str2         | 2020-01-02 01:00:00.123456 |
| 3                    | 30   | 3000        | 3234.432100  | 32345678.99  | null         | 2020-01-03 01:00:00.123456 |
| 4                    | 40   | 4000        | null         | 42345678.99  | str4         | 2020-01-04 01:00:00.123456 |
| 6                    | null | 6000        | 6234.432100  | 62345678.99  | str6         | 2020-01-06 01:00:00.123456 |
| 7                    | 70   | 7000        | 7234.432100  | null         | str7         | 2020-01-07 01:00:00.123456 |
| 9                    | 90   | 9000        | 9234.432100  | 92345678.99  | str9         | 2020-01-09 01:00:00.123456 |
| 10                   | 100  | 10000       | 10234.432100 | 93345678.99  | str10        | 2020-01-10 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
8 rows returned
select * from test_source_1 where col3 <> 3234.4321 order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 1                    | 10   | 1000        | 1234.432100  | 12345678.99  | str1         | 2020-01-01 01:00:00.123456 |
| 2                    | 20   | 2000        | 2234.432100  | 22345678.99  | str2         | 2020-01-02 01:00:00.123456 |
| 5                    | 50   | 5000        | 5234.432100  | 52345678.99  | str5         | 2020-01-05 01:00:00.123456 |
| 6                    | null | 6000        | 6234.432100  | 62345678.99  | str6         | 2020-01-06 01:00:00.123456 |
| 7                    | 70   | 7000        | 7234.432100  | null         | str7         | 2020-01-07 01:00:00.123456 |
| 8                    | 80   | null        | 8234.432100  | 82345678.99  | str8         | null                       |
| 9                    | 90   | 9000        | 9234.432100  | 92345678.99  | str9         | 2020-01-09 01:00:00.123456 |
| 10                   | 100  | 10000       | 10234.432100 | 93345678.99  | str10        | 2020-01-10 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
8 rows returned
select * from test_source_1 where col4 <> 22345678.99 order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 1                    | 10   | 1000        | 1234.432100  | 12345678.99  | str1         | 2020-01-01 01:00:00.123456 |
| 3                    | 30   | 3000        | 3234.432100  | 32345678.99  | null         | 2020-01-03 01:00:00.123456 |
| 4                    | 40   | 4000        | null         | 42345678.99  | str4         | 2020-01-04 01:00:00.123456 |
| 5                    | 50   | 5000        | 5234.432100  | 52345678.99  | str5         | 2020-01-05 01:00:00.123456 |
| 6                    | null | 6000        | 6234.432100  | 62345678.99  | str6         | 2020-01-06 01:00:00.123456 |
| 8                    | 80   | null        | 8234.432100  | 82345678.99  | str8         | null                       |
| 9                    | 90   | 9000        | 9234.432100  | 92345678.99  | str9         | 2020-01-09 01:00:00.123456 |
| 10                   | 100  | 10000       | 10234.432100 | 93345678.99  | str10        | 2020-01-10 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
8 rows returned
select * from test_source_1 where col5 <> 'str7' order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 1                    | 10   | 1000        | 1234.432100  | 12345678.99  | str1         | 2020-01-01 01:00:00.123456 |
| 2                    | 20   | 2000        | 2234.432100  | 22345678.99  | str2         | 2020-01-02 01:00:00.123456 |
| 4                    | 40   | 4000        | null         | 42345678.99  | str4         | 2020-01-04 01:00:00.123456 |
| 5                    | 50   | 5000        | 5234.432100  | 52345678.99  | str5         | 2020-01-05 01:00:00.123456 |
| 6                    | null | 6000        | 6234.432100  | 62345678.99  | str6         | 2020-01-06 01:00:00.123456 |
| 8                    | 80   | null        | 8234.432100  | 82345678.99  | str8         | null                       |
| 9                    | 90   | 9000        | 9234.432100  | 92345678.99  | str9         | 2020-01-09 01:00:00.123456 |
| 10                   | 100  | 10000       | 10234.432100 | 93345678.99  | str10        | 2020-01-10 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
8 rows returned
select * from test_source_1 where col6 <> '2020-01-04 01:00:00.123456' order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 1                    | 10   | 1000        | 1234.432100  | 12345678.99  | str1         | 2020-01-01 01:00:00.123456 |
| 2                    | 20   | 2000        | 2234.432100  | 22345678.99  | str2         | 2020-01-02 01:00:00.123456 |
| 3                    | 30   | 3000        | 3234.432100  | 32345678.99  | null         | 2020-01-03 01:00:00.123456 |
| 5                    | 50   | 5000        | 5234.432100  | 52345678.99  | str5         | 2020-01-05 01:00:00.123456 |
| 6                    | null | 6000        | 6234.432100  | 62345678.99  | str6         | 2020-01-06 01:00:00.123456 |
| 7                    | 70   | 7000        | 7234.432100  | null         | str7         | 2020-01-07 01:00:00.123456 |
| 9                    | 90   | 9000        | 9234.432100  | 92345678.99  | str9         | 2020-01-09 01:00:00.123456 |
| 10                   | 100  | 10000       | 10234.432100 | 93345678.99  | str10        | 2020-01-10 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
8 rows returned

-- IS NULL;
select * from test_source_1 where col1 is null order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 6                    | null | 6000        | 6234.432100  | 62345678.99  | str6         | 2020-01-06 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from test_source_1 where col2 is null order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 8                    | 80   | null        | 8234.432100  | 82345678.99  | str8         | null                       |
+---------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from test_source_1 where col3 is null order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 4                    | 40   | 4000        | null         | 42345678.99  | str4         | 2020-01-04 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from test_source_1 where col4 is null order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 7                    | 70   | 7000        | 7234.432100  | null         | str7         | 2020-01-07 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from test_source_1 where col5 is null order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 3                    | 30   | 3000        | 3234.432100  | 32345678.99  | null         | 2020-01-03 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from test_source_1 where col6 is null order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 8                    | 80   | null        | 8234.432100  | 82345678.99  | str8         | null                       |
+---------------------------------------------------------------------------------------------------------------------+
1 rows returned

-- IS NOT NULL;
select * from test_source_1 where col1 is not null order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 1                    | 10   | 1000        | 1234.432100  | 12345678.99  | str1         | 2020-01-01 01:00:00.123456 |
| 2                    | 20   | 2000        | 2234.432100  | 22345678.99  | str2         | 2020-01-02 01:00:00.123456 |
| 3                    | 30   | 3000        | 3234.432100  | 32345678.99  | null         | 2020-01-03 01:00:00.123456 |
| 4                    | 40   | 4000        | null         | 42345678.99  | str4         | 2020-01-04 01:00:00.123456 |
| 5                    | 50   | 5000        | 5234.432100  | 52345678.99  | str5         | 2020-01-05 01:00:00.123456 |
| 7                    | 70   | 7000        | 7234.432100  | null         | str7         | 2020-01-07 01:00:00.123456 |
| 8                    | 80   | null        | 8234.432100  | 82345678.99  | str8         | null                       |
| 9                    | 90   | 9000        | 9234.432100  | 92345678.99  | str9         | 2020-01-09 01:00:00.123456 |
| 10                   | 100  | 10000       | 10234.432100 | 93345678.99  | str10        | 2020-01-10 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
9 rows returned
select * from test_source_1 where col2 is not null order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 1                    | 10   | 1000        | 1234.432100  | 12345678.99  | str1         | 2020-01-01 01:00:00.123456 |
| 2                    | 20   | 2000        | 2234.432100  | 22345678.99  | str2         | 2020-01-02 01:00:00.123456 |
| 3                    | 30   | 3000        | 3234.432100  | 32345678.99  | null         | 2020-01-03 01:00:00.123456 |
| 4                    | 40   | 4000        | null         | 42345678.99  | str4         | 2020-01-04 01:00:00.123456 |
| 5                    | 50   | 5000        | 5234.432100  | 52345678.99  | str5         | 2020-01-05 01:00:00.123456 |
| 6                    | null | 6000        | 6234.432100  | 62345678.99  | str6         | 2020-01-06 01:00:00.123456 |
| 7                    | 70   | 7000        | 7234.432100  | null         | str7         | 2020-01-07 01:00:00.123456 |
| 9                    | 90   | 9000        | 9234.432100  | 92345678.99  | str9         | 2020-01-09 01:00:00.123456 |
| 10                   | 100  | 10000       | 10234.432100 | 93345678.99  | str10        | 2020-01-10 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
9 rows returned
select * from test_source_1 where col3 is not null order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 1                    | 10   | 1000        | 1234.432100  | 12345678.99  | str1         | 2020-01-01 01:00:00.123456 |
| 2                    | 20   | 2000        | 2234.432100  | 22345678.99  | str2         | 2020-01-02 01:00:00.123456 |
| 3                    | 30   | 3000        | 3234.432100  | 32345678.99  | null         | 2020-01-03 01:00:00.123456 |
| 5                    | 50   | 5000        | 5234.432100  | 52345678.99  | str5         | 2020-01-05 01:00:00.123456 |
| 6                    | null | 6000        | 6234.432100  | 62345678.99  | str6         | 2020-01-06 01:00:00.123456 |
| 7                    | 70   | 7000        | 7234.432100  | null         | str7         | 2020-01-07 01:00:00.123456 |
| 8                    | 80   | null        | 8234.432100  | 82345678.99  | str8         | null                       |
| 9                    | 90   | 9000        | 9234.432100  | 92345678.99  | str9         | 2020-01-09 01:00:00.123456 |
| 10                   | 100  | 10000       | 10234.432100 | 93345678.99  | str10        | 2020-01-10 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
9 rows returned
select * from test_source_1 where col4 is not null order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 1                    | 10   | 1000        | 1234.432100  | 12345678.99  | str1         | 2020-01-01 01:00:00.123456 |
| 2                    | 20   | 2000        | 2234.432100  | 22345678.99  | str2         | 2020-01-02 01:00:00.123456 |
| 3                    | 30   | 3000        | 3234.432100  | 32345678.99  | null         | 2020-01-03 01:00:00.123456 |
| 4                    | 40   | 4000        | null         | 42345678.99  | str4         | 2020-01-04 01:00:00.123456 |
| 5                    | 50   | 5000        | 5234.432100  | 52345678.99  | str5         | 2020-01-05 01:00:00.123456 |
| 6                    | null | 6000        | 6234.432100  | 62345678.99  | str6         | 2020-01-06 01:00:00.123456 |
| 8                    | 80   | null        | 8234.432100  | 82345678.99  | str8         | null                       |
| 9                    | 90   | 9000        | 9234.432100  | 92345678.99  | str9         | 2020-01-09 01:00:00.123456 |
| 10                   | 100  | 10000       | 10234.432100 | 93345678.99  | str10        | 2020-01-10 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
9 rows returned
select * from test_source_1 where col5 is not null order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 1                    | 10   | 1000        | 1234.432100  | 12345678.99  | str1         | 2020-01-01 01:00:00.123456 |
| 2                    | 20   | 2000        | 2234.432100  | 22345678.99  | str2         | 2020-01-02 01:00:00.123456 |
| 4                    | 40   | 4000        | null         | 42345678.99  | str4         | 2020-01-04 01:00:00.123456 |
| 5                    | 50   | 5000        | 5234.432100  | 52345678.99  | str5         | 2020-01-05 01:00:00.123456 |
| 6                    | null | 6000        | 6234.432100  | 62345678.99  | str6         | 2020-01-06 01:00:00.123456 |
| 7                    | 70   | 7000        | 7234.432100  | null         | str7         | 2020-01-07 01:00:00.123456 |
| 8                    | 80   | null        | 8234.432100  | 82345678.99  | str8         | null                       |
| 9                    | 90   | 9000        | 9234.432100  | 92345678.99  | str9         | 2020-01-09 01:00:00.123456 |
| 10                   | 100  | 10000       | 10234.432100 | 93345678.99  | str10        | 2020-01-10 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
9 rows returned
select * from test_source_1 where col6 is not null order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 1                    | 10   | 1000        | 1234.432100  | 12345678.99  | str1         | 2020-01-01 01:00:00.123456 |
| 2                    | 20   | 2000        | 2234.432100  | 22345678.99  | str2         | 2020-01-02 01:00:00.123456 |
| 3                    | 30   | 3000        | 3234.432100  | 32345678.99  | null         | 2020-01-03 01:00:00.123456 |
| 4                    | 40   | 4000        | null         | 42345678.99  | str4         | 2020-01-04 01:00:00.123456 |
| 5                    | 50   | 5000        | 5234.432100  | 52345678.99  | str5         | 2020-01-05 01:00:00.123456 |
| 6                    | null | 6000        | 6234.432100  | 62345678.99  | str6         | 2020-01-06 01:00:00.123456 |
| 7                    | 70   | 7000        | 7234.432100  | null         | str7         | 2020-01-07 01:00:00.123456 |
| 9                    | 90   | 9000        | 9234.432100  | 92345678.99  | str9         | 2020-01-09 01:00:00.123456 |
| 10                   | 100  | 10000       | 10234.432100 | 93345678.99  | str10        | 2020-01-10 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
9 rows returned

-- AND;
select * from test_source_1 where col1 > 30 and col2 <= 9000 order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 4                    | 40   | 4000        | null         | 42345678.99  | str4         | 2020-01-04 01:00:00.123456 |
| 5                    | 50   | 5000        | 5234.432100  | 52345678.99  | str5         | 2020-01-05 01:00:00.123456 |
| 7                    | 70   | 7000        | 7234.432100  | null         | str7         | 2020-01-07 01:00:00.123456 |
| 9                    | 90   | 9000        | 9234.432100  | 92345678.99  | str9         | 2020-01-09 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
4 rows returned

-- OR;
select * from test_source_1 where col1 = 80 or col5 = 'str4' order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 4                    | 40   | 4000        | null         | 42345678.99  | str4         | 2020-01-04 01:00:00.123456 |
| 8                    | 80   | null        | 8234.432100  | 82345678.99  | str8         | null                       |
+---------------------------------------------------------------------------------------------------------------------+
2 rows returned

-- IF;
select col0, if(col0 > 4, "bigger", "smaller"),
if (col1 > 30, "bigger", "smaller"),
if (col2 > 7000, "bigger", "smaller"),
if (col3 = 6234.4321, "eq", "not eq"),
if (col4 <= 82345678.99, "less", "more"),
if (col5 > 'str3', 'fatter', 'thinner'),
if (col6 = '2020-01-03 01:00:00.123456', 'wibble', 'wobble')
from test_source_1 order by col0;
+-----------------------------------------------------------------------------------------------------------------+
| col0                 | if(col0 .. | if (col1.. | if (col2.. | if (col3.. | if (col4.. | if (col5.. | if (col6.. |
+-----------------------------------------------------------------------------------------------------------------+
| 1                    | smaller    | smaller    | smaller    | not eq     | less       | thinner    | wobble     |
| 2                    | smaller    | smaller    | smaller    | not eq     | less       | thinner    | wobble     |
| 3                    | smaller    | smaller    | smaller    | not eq     | less       | thinner    | wibble     |
| 4                    | smaller    | bigger     | smaller    | not eq     | less       | fatter     | wobble     |
| 5                    | bigger     | bigger     | smaller    | not eq     | less       | fatter     | wobble     |
| 6                    | bigger     | smaller    | smaller    | eq         | less       | fatter     | wobble     |
| 7                    | bigger     | bigger     | smaller    | not eq     | more       | fatter     | wobble     |
| 8                    | bigger     | bigger     | smaller    | not eq     | less       | fatter     | wobble     |
| 9                    | bigger     | bigger     | bigger     | not eq     | more       | fatter     | wobble     |
| 10                   | bigger     | bigger     | bigger     | not eq     | more       | thinner    | wobble     |
+-----------------------------------------------------------------------------------------------------------------+
10 rows returned

-- CASE;
select col0,
case
when col1 = 30 then "3 hundred"
when col1 = 50 then "5 hundred"
when col1 is null then "eeets null"
else "badgers"
end from test_source_1 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | case
when col1 = 30 then "3 hundred"
when col1 = 50 then "5 hundred"
when col1 is null then.. |
+----------------------------------------------------------------------------------------------------------------------+
| 1                    | badgers                                                                                       |
| 2                    | badgers                                                                                       |
| 3                    | 3 hundred                                                                                     |
| 4                    | badgers                                                                                       |
| 5                    | 5 hundred                                                                                     |
| 6                    | eeets null                                                                                    |
| 7                    | badgers                                                                                       |
| 8                    | badgers                                                                                       |
| 9                    | badgers                                                                                       |
| 10                   | badgers                                                                                       |
+----------------------------------------------------------------------------------------------------------------------+
10 rows returned

-- IN;
select * from test_source_1 where col2 in (4000, 7000, 3000) order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 3                    | 30   | 3000        | 3234.432100  | 32345678.99  | null         | 2020-01-03 01:00:00.123456 |
| 4                    | 40   | 4000        | null         | 42345678.99  | str4         | 2020-01-04 01:00:00.123456 |
| 7                    | 70   | 7000        | 7234.432100  | null         | str7         | 2020-01-07 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
3 rows returned

--UNARY MINUS;
select -col0, -col1, -col2, -col3, -col4 from test_source_1 order by -col0;
+----------------------------------------------------------------------------------------------------------------------+
| -col0                | -col1                | -col2                | -col3                  | -col4                  |
+----------------------------------------------------------------------------------------------------------------------+
| -10                  | -100                 | -10000               | -10234.432100          | -93345678.99           |
| -9                   | -90                  | -9000                | -9234.432100           | -92345678.99           |
| -8                   | -80                  | null                 | -8234.432100           | -82345678.99           |
| -7                   | -70                  | -7000                | -7234.432100           | null                   |
| -6                   | null                 | -6000                | -6234.432100           | -62345678.99           |
| -5                   | -50                  | -5000                | -5234.432100           | -52345678.99           |
| -4                   | -40                  | -4000                | null                   | -42345678.99           |
| -3                   | -30                  | -3000                | -3234.432100           | -32345678.99           |
| -2                   | -20                  | -2000                | -2234.432100           | -22345678.99           |
| -1                   | -10                  | -1000                | -1234.432100           | -12345678.99           |
+----------------------------------------------------------------------------------------------------------------------+
10 rows returned

--UNARY NOT;
select * from test_source_1 where not col1 = 400 order by col0;
+---------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3         | col4         | col5         | col6                       |
+---------------------------------------------------------------------------------------------------------------------+
| 1                    | 10   | 1000        | 1234.432100  | 12345678.99  | str1         | 2020-01-01 01:00:00.123456 |
| 2                    | 20   | 2000        | 2234.432100  | 22345678.99  | str2         | 2020-01-02 01:00:00.123456 |
| 3                    | 30   | 3000        | 3234.432100  | 32345678.99  | null         | 2020-01-03 01:00:00.123456 |
| 4                    | 40   | 4000        | null         | 42345678.99  | str4         | 2020-01-04 01:00:00.123456 |
| 5                    | 50   | 5000        | 5234.432100  | 52345678.99  | str5         | 2020-01-05 01:00:00.123456 |
| 7                    | 70   | 7000        | 7234.432100  | null         | str7         | 2020-01-07 01:00:00.123456 |
| 8                    | 80   | null        | 8234.432100  | 82345678.99  | str8         | null                       |
| 9                    | 90   | 9000        | 9234.432100  | 92345678.99  | str9         | 2020-01-09 01:00:00.123456 |
| 10                   | 100  | 10000       | 10234.432100 | 93345678.99  | str10        | 2020-01-10 01:00:00.123456 |
+---------------------------------------------------------------------------------------------------------------------+
9 rows returned

--IFNULL;
select col0, ifnull(col1, 'eeeetz null!') from test_source_1 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | ifnull(col1, 'eeeetz null!')                                                                  |
+----------------------------------------------------------------------------------------------------------------------+
| 1                    | 10                                                                                            |
| 2                    | 20                                                                                            |
| 3                    | 30                                                                                            |
| 4                    | 40                                                                                            |
| 5                    | 50                                                                                            |
| 6                    | eeeetz null!                                                                                  |
| 7                    | 70                                                                                            |
| 8                    | 80                                                                                            |
| 9                    | 90                                                                                            |
| 10                   | 100                                                                                           |
+----------------------------------------------------------------------------------------------------------------------+
10 rows returned

--LIKE;
--create topic testtopic2;
create source test_source_2(
    col0 bigint,
    col1 varchar,
    primary key (col0)
) with (
    brokername = "testbroker",
    topicname = "testtopic2",
    headerencoding = "json",
    keyencoding = "json",
    valueencoding = "json",
    columnselectors = (
        meta("key").k0,
        v1
    )
);
0 rows returned

--load data dataset_2;

select * from test_source_2 where col1 like 'a%' order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 1                    | aubergines                                                                                    |
| 2                    | apples                                                                                        |
| 6                    | avocados                                                                                      |
+----------------------------------------------------------------------------------------------------------------------+
3 rows returned
select * from test_source_2 where col1 like '%r' order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 8                    | beer                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from test_source_2 where col1 like '%ee%' order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 7                    | cheese                                                                                        |
| 8                    | beer                                                                                          |
| 9                    | geese                                                                                         |
+----------------------------------------------------------------------------------------------------------------------+
3 rows returned
select * from test_source_2 where col1 like '_e%' order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 4                    | pears                                                                                         |
| 5                    | lemons                                                                                        |
| 8                    | beer                                                                                          |
| 9                    | geese                                                                                         |
+----------------------------------------------------------------------------------------------------------------------+
4 rows returned
select * from test_source_2 where col1 like 'a_______%' order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 1                    | aubergines                                                                                    |
| 6                    | avocados                                                                                      |
+----------------------------------------------------------------------------------------------------------------------+
2 rows returned
select * from test_source_2 where col1 like 'a%s' order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 1                    | aubergines                                                                                    |
| 2                    | apples                                                                                        |
| 6                    | avocados                                                                                      |
+----------------------------------------------------------------------------------------------------------------------+
3 rows returned

-- Logic ops/functions;

--create topic testtopic3;
create source test_source_3(
    col0 bigint,
    col1 tinyint,
    col2 tinyint,
    primary key (col0)
) with (
    brokername = "testbroker",
    topicname = "testtopic3",
    headerencoding = "json",
    keyencoding = "json",
    valueencoding = "json",
    columnselectors = (
        meta("key").k0,
        v1,
        v2
    )
);
0 rows returned

--load data dataset_3;

-- IS TRUE;
select * from test_source_3 where col1 is true;
+------------------------------------+
| col0                 | col1 | col2 |
+------------------------------------+
| 9                    | 1    | 0    |
| 4                    | 1    | 1    |
| 1                    | 1    | 1    |
| 6                    | 1    | 0    |
+------------------------------------+
4 rows returned
select * from test_source_3 where col2 is true;
+------------------------------------+
| col0                 | col1 | col2 |
+------------------------------------+
| 7                    | null | 1    |
| 4                    | 1    | 1    |
| 5                    | 0    | 1    |
| 1                    | 1    | 1    |
| 8                    | 0    | 1    |
+------------------------------------+
5 rows returned

-- IS FALSE;
select * from test_source_3 where col1 is false;
+------------------------------------+
| col0                 | col1 | col2 |
+------------------------------------+
| 2                    | 0    | 0    |
| 3                    | 0    | null |
| 5                    | 0    | 1    |
| 8                    | 0    | 1    |
+------------------------------------+
4 rows returned
select * from test_source_3 where col2 is false;
+------------------------------------+
| col0                 | col1 | col2 |
+------------------------------------+
| 9                    | 1    | 0    |
| 2                    | 0    | 0    |
| 6                    | 1    | 0    |
+------------------------------------+
3 rows returned

select * from test_source_3 where col1 and col2;
+------------------------------------+
| col0                 | col1 | col2 |
+------------------------------------+
| 4                    | 1    | 1    |
| 1                    | 1    | 1    |
+------------------------------------+
2 rows returned
select * from test_source_3 where col1 or col2;
+------------------------------------+
| col0                 | col1 | col2 |
+------------------------------------+
| 7                    | null | 1    |
| 9                    | 1    | 0    |
| 4                    | 1    | 1    |
| 5                    | 0    | 1    |
| 1                    | 1    | 1    |
| 8                    | 0    | 1    |
| 6                    | 1    | 0    |
+------------------------------------+
7 rows returned
select * from test_source_3 where col1 xor col2;
+------------------------------------+
| col0                 | col1 | col2 |
+------------------------------------+
| 9                    | 1    | 0    |
| 5                    | 0    | 1    |
| 8                    | 0    | 1    |
| 6                    | 1    | 0    |
+------------------------------------+
4 rows returned

select * from test_source_3 where not col1;
+------------------------------------+
| col0                 | col1 | col2 |
+------------------------------------+
| 2                    | 0    | 0    |
| 3                    | 0    | null |
| 5                    | 0    | 1    |
| 8                    | 0    | 1    |
+------------------------------------+
4 rows returned

-- basic arithmetic;

-- ADD;

select col0 + 10 from test_source_1 order by col0;
+----------------------+
| col0 + 10            |
+----------------------+
| 11                   |
| 12                   |
| 13                   |
| 14                   |
| 15                   |
| 16                   |
| 17                   |
| 18                   |
| 19                   |
| 20                   |
+----------------------+
10 rows returned
select col1 + 10 from test_source_1 order by col0;
+----------------------+
| col1 + 10            |
+----------------------+
| 20                   |
| 30                   |
| 40                   |
| 50                   |
| 60                   |
| null                 |
| 80                   |
| 90                   |
| 100                  |
| 110                  |
+----------------------+
10 rows returned
select col2 + 10 from test_source_1 order by col0;
+----------------------+
| col2 + 10            |
+----------------------+
| 1010                 |
| 2010                 |
| 3010                 |
| 4010                 |
| 5010                 |
| 6010                 |
| 7010                 |
| null                 |
| 9010                 |
| 10010                |
+----------------------+
10 rows returned
select col3 + 100000.0001 from test_source_1 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col3 + 100000.0001                                                                                                   |
+----------------------------------------------------------------------------------------------------------------------+
| 101234.432200                                                                                                        |
| 102234.432200                                                                                                        |
| 103234.432200                                                                                                        |
| null                                                                                                                 |
| 105234.432200                                                                                                        |
| 106234.432200                                                                                                        |
| 107234.432200                                                                                                        |
| 108234.432200                                                                                                        |
| 109234.432200                                                                                                        |
| 110234.432200                                                                                                        |
+----------------------------------------------------------------------------------------------------------------------+
10 rows returned
select col4 + 100000 from test_source_1 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col4 + 100000                                                                                                        |
+----------------------------------------------------------------------------------------------------------------------+
| 12445678.99                                                                                                          |
| 22445678.99                                                                                                          |
| 32445678.99                                                                                                          |
| 42445678.99                                                                                                          |
| 52445678.99                                                                                                          |
| 62445678.99                                                                                                          |
| null                                                                                                                 |
| 82445678.99                                                                                                          |
| 92445678.99                                                                                                          |
| 93445678.99                                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
10 rows returned

select col0 + col0 from test_source_1 order by col0;
+----------------------+
| col0 + col0          |
+----------------------+
| 2                    |
| 4                    |
| 6                    |
| 8                    |
| 10                   |
| 12                   |
| 14                   |
| 16                   |
| 18                   |
| 20                   |
+----------------------+
10 rows returned
select col1 + col1 from test_source_1 order by col0;
+----------------------+
| col1 + col1          |
+----------------------+
| 20                   |
| 40                   |
| 60                   |
| 80                   |
| 100                  |
| null                 |
| 140                  |
| 160                  |
| 180                  |
| 200                  |
+----------------------+
10 rows returned
select col2 + col2 from test_source_1 order by col0;
+----------------------+
| col2 + col2          |
+----------------------+
| 2000                 |
| 4000                 |
| 6000                 |
| 8000                 |
| 10000                |
| 12000                |
| 14000                |
| null                 |
| 18000                |
| 20000                |
+----------------------+
10 rows returned
select col3 + col3 from test_source_1 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col3 + col3                                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 2468.864200                                                                                                          |
| 4468.864200                                                                                                          |
| 6468.864200                                                                                                          |
| null                                                                                                                 |
| 10468.864200                                                                                                         |
| 12468.864200                                                                                                         |
| 14468.864200                                                                                                         |
| 16468.864200                                                                                                         |
| 18468.864200                                                                                                         |
| 20468.864200                                                                                                         |
+----------------------------------------------------------------------------------------------------------------------+
10 rows returned
select col4 + col4 from test_source_1 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col4 + col4                                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 24691357.98                                                                                                          |
| 44691357.98                                                                                                          |
| 64691357.98                                                                                                          |
| 84691357.98                                                                                                          |
| 104691357.98                                                                                                         |
| 124691357.98                                                                                                         |
| null                                                                                                                 |
| 164691357.98                                                                                                         |
| 184691357.98                                                                                                         |
| 186691357.98                                                                                                         |
+----------------------------------------------------------------------------------------------------------------------+
10 rows returned

select col0 + col1 + col2 + col3 + col4 from test_source_1 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0 + col1 + col2 + col3 + col4                                                                                     |
+----------------------------------------------------------------------------------------------------------------------+
| 12347924.422100                                                                                                      |
| 22349935.422100                                                                                                      |
| 32351946.422100                                                                                                      |
| null                                                                                                                 |
| 52355968.422100                                                                                                      |
| null                                                                                                                 |
| null                                                                                                                 |
| null                                                                                                                 |
| 92364012.422100                                                                                                      |
| 93366023.422100                                                                                                      |
+----------------------------------------------------------------------------------------------------------------------+
10 rows returned

-- SUBTRACT;

select col0 - 10 from test_source_1 order by col0;
+----------------------+
| col0 - 10            |
+----------------------+
| -9                   |
| -8                   |
| -7                   |
| -6                   |
| -5                   |
| -4                   |
| -3                   |
| -2                   |
| -1                   |
| 0                    |
+----------------------+
10 rows returned
select col1 - 10 from test_source_1 order by col0;
+----------------------+
| col1 - 10            |
+----------------------+
| 0                    |
| 10                   |
| 20                   |
| 30                   |
| 40                   |
| null                 |
| 60                   |
| 70                   |
| 80                   |
| 90                   |
+----------------------+
10 rows returned
select col2 - 10 from test_source_1 order by col0;
+----------------------+
| col2 - 10            |
+----------------------+
| 990                  |
| 1990                 |
| 2990                 |
| 3990                 |
| 4990                 |
| 5990                 |
| 6990                 |
| null                 |
| 8990                 |
| 9990                 |
+----------------------+
10 rows returned
select col3 - 100000.0001 from test_source_1 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col3 - 100000.0001                                                                                                   |
+----------------------------------------------------------------------------------------------------------------------+
| -98765.568000                                                                                                        |
| -97765.568000                                                                                                        |
| -96765.568000                                                                                                        |
| null                                                                                                                 |
| -94765.568000                                                                                                        |
| -93765.568000                                                                                                        |
| -92765.568000                                                                                                        |
| -91765.568000                                                                                                        |
| -90765.568000                                                                                                        |
| -89765.568000                                                                                                        |
+----------------------------------------------------------------------------------------------------------------------+
10 rows returned
select col4 - 100000 from test_source_1 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col4 - 100000                                                                                                        |
+----------------------------------------------------------------------------------------------------------------------+
| 12245678.99                                                                                                          |
| 22245678.99                                                                                                          |
| 32245678.99                                                                                                          |
| 42245678.99                                                                                                          |
| 52245678.99                                                                                                          |
| 62245678.99                                                                                                          |
| null                                                                                                                 |
| 82245678.99                                                                                                          |
| 92245678.99                                                                                                          |
| 93245678.99                                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
10 rows returned

select 2 * col0 - col0 from test_source_1 order by col0;
+----------------------+
| 2 * col0 - col0      |
+----------------------+
| 1                    |
| 2                    |
| 3                    |
| 4                    |
| 5                    |
| 6                    |
| 7                    |
| 8                    |
| 9                    |
| 10                   |
+----------------------+
10 rows returned
select 2 * col1 - col1 from test_source_1 order by col0;
+----------------------+
| 2 * col1 - col1      |
+----------------------+
| 10                   |
| 20                   |
| 30                   |
| 40                   |
| 50                   |
| null                 |
| 70                   |
| 80                   |
| 90                   |
| 100                  |
+----------------------+
10 rows returned
select 2 * col2 - col2 from test_source_1 order by col0;
+----------------------+
| 2 * col2 - col2      |
+----------------------+
| 1000                 |
| 2000                 |
| 3000                 |
| 4000                 |
| 5000                 |
| 6000                 |
| 7000                 |
| null                 |
| 9000                 |
| 10000                |
+----------------------+
10 rows returned
select 2 * col3 - col3 from test_source_1 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| 2 * col3 - col3                                                                                                      |
+----------------------------------------------------------------------------------------------------------------------+
| 1234.432100                                                                                                          |
| 2234.432100                                                                                                          |
| 3234.432100                                                                                                          |
| null                                                                                                                 |
| 5234.432100                                                                                                          |
| 6234.432100                                                                                                          |
| 7234.432100                                                                                                          |
| 8234.432100                                                                                                          |
| 9234.432100                                                                                                          |
| 10234.432100                                                                                                         |
+----------------------------------------------------------------------------------------------------------------------+
10 rows returned
select 2 * col4 - col4 from test_source_1 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| 2 * col4 - col4                                                                                                      |
+----------------------------------------------------------------------------------------------------------------------+
| 12345678.99                                                                                                          |
| 22345678.99                                                                                                          |
| 32345678.99                                                                                                          |
| 42345678.99                                                                                                          |
| 52345678.99                                                                                                          |
| 62345678.99                                                                                                          |
| null                                                                                                                 |
| 82345678.99                                                                                                          |
| 92345678.99                                                                                                          |
| 93345678.99                                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
10 rows returned

select col4 - col3 - col2 - col1 - col0 from test_source_1 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col4 - col3 - col2 - col1 - col0                                                                                     |
+----------------------------------------------------------------------------------------------------------------------+
| 12343433.557900                                                                                                      |
| 22341422.557900                                                                                                      |
| 32339411.557900                                                                                                      |
| null                                                                                                                 |
| 52335389.557900                                                                                                      |
| null                                                                                                                 |
| null                                                                                                                 |
| null                                                                                                                 |
| 92327345.557900                                                                                                      |
| 93325334.557900                                                                                                      |
+----------------------------------------------------------------------------------------------------------------------+
10 rows returned

-- MULTIPLY;

select col0 * 2 from test_source_1 order by col0;
+----------------------+
| col0 * 2             |
+----------------------+
| 2                    |
| 4                    |
| 6                    |
| 8                    |
| 10                   |
| 12                   |
| 14                   |
| 16                   |
| 18                   |
| 20                   |
+----------------------+
10 rows returned
select col1 * 2 from test_source_1 order by col0;
+----------------------+
| col1 * 2             |
+----------------------+
| 20                   |
| 40                   |
| 60                   |
| 80                   |
| 100                  |
| null                 |
| 140                  |
| 160                  |
| 180                  |
| 200                  |
+----------------------+
10 rows returned
select col2 * 2 from test_source_1 order by col0;
+----------------------+
| col2 * 2             |
+----------------------+
| 2000                 |
| 4000                 |
| 6000                 |
| 8000                 |
| 10000                |
| 12000                |
| 14000                |
| null                 |
| 18000                |
| 20000                |
+----------------------+
10 rows returned
select col3 * 2 from test_source_1 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col3 * 2                                                                                                             |
+----------------------------------------------------------------------------------------------------------------------+
| 2468.864200                                                                                                          |
| 4468.864200                                                                                                          |
| 6468.864200                                                                                                          |
| null                                                                                                                 |
| 10468.864200                                                                                                         |
| 12468.864200                                                                                                         |
| 14468.864200                                                                                                         |
| 16468.864200                                                                                                         |
| 18468.864200                                                                                                         |
| 20468.864200                                                                                                         |
+----------------------------------------------------------------------------------------------------------------------+
10 rows returned
select col4 * 2 from test_source_1 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col4 * 2                                                                                                             |
+----------------------------------------------------------------------------------------------------------------------+
| 24691357.98                                                                                                          |
| 44691357.98                                                                                                          |
| 64691357.98                                                                                                          |
| 84691357.98                                                                                                          |
| 104691357.98                                                                                                         |
| 124691357.98                                                                                                         |
| null                                                                                                                 |
| 164691357.98                                                                                                         |
| 184691357.98                                                                                                         |
| 186691357.98                                                                                                         |
+----------------------------------------------------------------------------------------------------------------------+
10 rows returned

select col0 * col1 from test_source_1 order by col0;
+----------------------+
| col0 * col1          |
+----------------------+
| 10                   |
| 40                   |
| 90                   |
| 160                  |
| 250                  |
| null                 |
| 490                  |
| 640                  |
| 810                  |
| 1000                 |
+----------------------+
10 rows returned

-- DIVIDE;

select col2 / col0 from test_source_1 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col2 / col0                                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 1000.000000000                                                                                                       |
| 1000.000000000                                                                                                       |
| 1000.000000000                                                                                                       |
| 1000.000000000                                                                                                       |
| 1000.000000000                                                                                                       |
| 1000.000000000                                                                                                       |
| 1000.000000000                                                                                                       |
| null                                                                                                                 |
| 1000.000000000                                                                                                       |
| 1000.000000000                                                                                                       |
+----------------------------------------------------------------------------------------------------------------------+
10 rows returned

select col0 / 2, col1 / 4, col2 / 2, col3 / 2, col4 / 2 from test_source_1 order by col0;
+------------------------------------------------------------------------------------------------------------------+
| col0 / 2             | col1 / 4             | col2 / 2             | col3 / 2             | col4 / 2             |
+------------------------------------------------------------------------------------------------------------------+
| 0.500000000          | 2.500000000          | 500.000000000        | 617.216050           | 6172839.495000000    |
| 1.000000000          | 5.000000000          | 1000.000000000       | 1117.216050          | 11172839.495000000   |
| 1.500000000          | 7.500000000          | 1500.000000000       | 1617.216050          | 16172839.495000000   |
| 2.000000000          | 10.000000000         | 2000.000000000       | null                 | 21172839.495000000   |
| 2.500000000          | 12.500000000         | 2500.000000000       | 2617.216050          | 26172839.495000000   |
| 3.000000000          | null                 | 3000.000000000       | 3117.216050          | 31172839.495000000   |
| 3.500000000          | 17.500000000         | 3500.000000000       | 3617.216050          | null                 |
| 4.000000000          | 20.000000000         | null                 | 4117.216050          | 41172839.495000000   |
| 4.500000000          | 22.500000000         | 4500.000000000       | 4617.216050          | 46172839.495000000   |
| 5.000000000          | 25.000000000         | 5000.000000000       | 5117.216050          | 46672839.495000000   |
+------------------------------------------------------------------------------------------------------------------+
10 rows returned

-- INTEGER DIVIDE;

select col0 div 2, col1 div 4, col2 div 2, col3 div 2, col4 div 2 from test_source_1 order by col0;
+------------------------------------------------------------------------------------------------------------------+
| col0 div 2           | col1 div 4           | col2 div 2           | col3 div 2           | col4 div 2           |
+------------------------------------------------------------------------------------------------------------------+
| 0                    | 2                    | 500                  | 617                  | 6172839              |
| 1                    | 5                    | 1000                 | 1117                 | 11172839             |
| 1                    | 7                    | 1500                 | 1617                 | 16172839             |
| 2                    | 10                   | 2000                 | null                 | 21172839             |
| 2                    | 12                   | 2500                 | 2617                 | 26172839             |
| 3                    | null                 | 3000                 | 3117                 | 31172839             |
| 3                    | 17                   | 3500                 | 3617                 | null                 |
| 4                    | 20                   | null                 | 4117                 | 41172839             |
| 4                    | 22                   | 4500                 | 4617                 | 46172839             |
| 5                    | 25                   | 5000                 | 5117                 | 46672839             |
+------------------------------------------------------------------------------------------------------------------+
10 rows returned

-- MOD;

select col0 mod 2 from test_source_1 order by col0;
+----------------------+
| col0 mod 2           |
+----------------------+
| 1                    |
| 0                    |
| 1                    |
| 0                    |
| 1                    |
| 0                    |
| 1                    |
| 0                    |
| 1                    |
| 0                    |
+----------------------+
10 rows returned

select col0 % 2 from test_source_1 order by col0;
+----------------------+
| col0 % 2             |
+----------------------+
| 1                    |
| 0                    |
| 1                    |
| 0                    |
| 1                    |
| 0                    |
| 1                    |
| 0                    |
| 1                    |
| 0                    |
+----------------------+
10 rows returned

select mod(col0, 2) from test_source_1 order by col0;
+----------------------+
| mod(col0, 2)         |
+----------------------+
| 1                    |
| 0                    |
| 1                    |
| 0                    |
| 1                    |
| 0                    |
| 1                    |
| 0                    |
| 1                    |
| 0                    |
+----------------------+
10 rows returned

-- Bitwise ops;

--create topic testtopic4;
create source test_source_4(
    col0 bigint,
    col1 tinyint,
    col2 int,
    col3 bigint,
    primary key (col0)
) with (
    brokername = "testbroker",
    topicname = "testtopic4",
    headerencoding = "json",
    keyencoding = "json",
    valueencoding = "json",
    columnselectors = (
        meta("key").k0,
        v1,
        v2,
        v3
    )
);
0 rows returned

--load data dataset_4;

-- BITWISE AND;

select col1 & 113, col2 & 45284648, col3 & 6983586634234 from test_source_4 order by col0;
+--------------------------------------------------------------------+
| col1 & 113           | col2 & 45284648      | col3 & 6983586634234 |
+--------------------------------------------------------------------+
| 113                  | 34643240             | 6701894029752        |
+--------------------------------------------------------------------+
1 rows returned

-- BITWISE OR;

select col1 | 113, col2 | 45284648, col3 | 6983586634234 from test_source_4 order by col0;
+--------------------------------------------------------------------+
| col1 | 113           | col2 | 45284648      | col3 | 6983586634234 |
+--------------------------------------------------------------------+
| 123                  | 1258225065           | 4836734448949755     |
+--------------------------------------------------------------------+
1 rows returned

-- BITWISE XOR;

select col1 ^ 113, col2 ^ 45284648, col3 ^ 6983586634234 from test_source_4 order by col0;
+--------------------------------------------------------------------+
| col1 ^ 113           | col2 ^ 45284648      | col3 ^ 6983586634234 |
+--------------------------------------------------------------------+
| 10                   | 1223581825           | 4830032554920003     |
+--------------------------------------------------------------------+
1 rows returned

-- BITWISE NEGATION;

select ~col1, ~col2, ~col3 from test_source_4 order by col0;
+--------------------------------------------------------------------+
| ~col1                | ~col2                | ~col3                |
+--------------------------------------------------------------------+
| -124                 | -1247583658          | -4836452756345274    |
+--------------------------------------------------------------------+
1 rows returned

-- BITWISE LEFT SHIFT;

select col1 << 1, col2 << 2, col3 << 2 from test_source_4 order by col0;
+--------------------------------------------------------------------+
| col1 << 1            | col2 << 2            | col3 << 2            |
+--------------------------------------------------------------------+
| 246                  | 4990334628           | 19345811025381092    |
+--------------------------------------------------------------------+
1 rows returned

-- BITWISE RIGHT SHIFT;

select col1 >> 1, col2 >> 2, col3 >> 3 from test_source_4 order by col0;
+--------------------------------------------------------------------+
| col1 >> 1            | col2 >> 2            | col3 >> 3            |
+--------------------------------------------------------------------+
| 61                   | 311895914            | 604556594543159      |
+--------------------------------------------------------------------+
1 rows returned

-- COALESCE;

select col0, coalesce(null, null, null, 'foo') from test_source_1 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | coalesce(null, null, null, 'foo')                                                             |
+----------------------------------------------------------------------------------------------------------------------+
| 1                    | foo                                                                                           |
| 2                    | foo                                                                                           |
| 3                    | foo                                                                                           |
| 4                    | foo                                                                                           |
| 5                    | foo                                                                                           |
| 6                    | foo                                                                                           |
| 7                    | foo                                                                                           |
| 8                    | foo                                                                                           |
| 9                    | foo                                                                                           |
| 10                   | foo                                                                                           |
+----------------------------------------------------------------------------------------------------------------------+
10 rows returned
select col0, coalesce(col1, col2, col3, col4) from test_source_1 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | coalesce(col1, col2, col3, col4)                                                              |
+----------------------------------------------------------------------------------------------------------------------+
| 1                    | 10.000000                                                                                     |
| 2                    | 20.000000                                                                                     |
| 3                    | 30.000000                                                                                     |
| 4                    | 40.000000                                                                                     |
| 5                    | 50.000000                                                                                     |
| 6                    | 6000.000000                                                                                   |
| 7                    | 70.000000                                                                                     |
| 8                    | 80.000000                                                                                     |
| 9                    | 90.000000                                                                                     |
| 10                   | 100.000000                                                                                    |
+----------------------------------------------------------------------------------------------------------------------+
10 rows returned

-- GREATEST / LEAST;

select col0, greatest(col1, col2, col3, col4), least(col1, col2, col3, col4), greatest(null, 1), least(null, 1), greatest(300, 200), least(300, 200) from test_source_1 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0           | greatest(col.. | least(col1, .. | greatest(nul.. | least(null, 1) | greatest(300.. | least(300, 2.. |
+----------------------------------------------------------------------------------------------------------------------+
| 1              | 12345678.990.. | 10.000000      | null           | null           | 300            | 200            |
| 2              | 22345678.990.. | 20.000000      | null           | null           | 300            | 200            |
| 3              | 32345678.990.. | 30.000000      | null           | null           | 300            | 200            |
| 4              | null           | null           | null           | null           | 300            | 200            |
| 5              | 52345678.990.. | 50.000000      | null           | null           | 300            | 200            |
| 6              | null           | null           | null           | null           | 300            | 200            |
| 7              | null           | null           | null           | null           | 300            | 200            |
| 8              | null           | null           | null           | null           | 300            | 200            |
| 9              | 92345678.990.. | 90.000000      | null           | null           | 300            | 200            |
| 10             | 93345678.990.. | 100.000000     | null           | null           | 300            | 200            |
+----------------------------------------------------------------------------------------------------------------------+
10 rows returned

-- INTERVAL;

select col0, interval(85, 1, 75, 17, 30,56, 175) from test_source_1 order by col0;
+------------------------------------------------------------+
| col0                 | interval(85, 1, 75, 17, 30,56, 175) |
+------------------------------------------------------------+
| 1                    | 5                                   |
| 2                    | 5                                   |
| 3                    | 5                                   |
| 4                    | 5                                   |
| 5                    | 5                                   |
| 6                    | 5                                   |
| 7                    | 5                                   |
| 8                    | 5                                   |
| 9                    | 5                                   |
| 10                   | 5                                   |
+------------------------------------------------------------+
10 rows returned

drop source test_source_4;
0 rows returned
drop source test_source_3;
0 rows returned
drop source test_source_2;
0 rows returned
drop source test_source_1;
0 rows returned

--delete topic testtopic4;
--delete topic testtopic3;
--delete topic testtopic2;
--delete topic testtopic;
;
