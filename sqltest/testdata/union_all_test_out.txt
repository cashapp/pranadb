--create topic testtopic1;
--create topic testtopic2;
use test;
0 rows returned
create source test_source_1(
    col0 bigint,
    col1 tinyint,
    col2 int,
    col3 double,
    col4 decimal(10, 2),
    col5 varchar,
    col6 timestamp(6),
    primary key (col0)
) with (
    brokername = "testbroker",
    topicname = "testtopic1",
    headerencoding = "json",
    keyencoding = "json",
    valueencoding = "json",
    columnselectors = (
        "k.k0",
        "v.v1",
        "v.v2",
        "v.v3",
        "v.v4",
        "v.v5",
        "v.v6"
    )
    properties = (
    )
);
0 rows returned
create source test_source_2(
    col0 bigint,
    col1 tinyint,
    col2 int,
    col3 double,
    col4 decimal(10, 2),
    col5 varchar,
    col6 timestamp(6),
    primary key (col0)
) with (
    brokername = "testbroker",
    topicname = "testtopic2",
    headerencoding = "json",
    keyencoding = "json",
    valueencoding = "json",
    columnselectors = (
        "k.k0",
        "v.v1",
        "v.v2",
        "v.v3",
        "v.v4",
        "v.v5",
        "v.v6"
    )
    properties = (
    )
);
0 rows returned

--load data dataset_1;
--load data dataset_2;

-- test with explicit columns;
create materialized view test_mv_1 as
select col0, col1, col2, col3, col4, col5, col6 from test_source_1
union all
select col0, col1, col2, col3, col4, col5, col6 from test_source_2;
0 rows returned

select * from test_mv_1 order by col0;
|col0|col1|col2|col3|col4|col5|col6|
|1|100|1000|1234.4321|12345678.99|str1|2020-01-01 01:00:00.123000|
|2|200|2000|2234.4321|22345678.99|str2|2020-01-02 01:00:00.123000|
|3|300|3000|3234.4321|32345678.99|str3|2020-01-03 01:00:00.123000|
|4|400|4000|4234.4321|42345678.99|str4|2020-01-04 01:00:00.123000|
|5|500|5000|5234.4321|52345678.99|str5|2020-01-05 01:00:00.123000|
|6|600|6000|6234.4321|62345678.99|str6|2020-01-06 01:00:00.123000|
|7|700|7000|7234.4321|72345678.99|str7|2020-01-07 01:00:00.123000|
|8|800|8000|8234.4321|82345678.99|str8|2020-01-08 01:00:00.123000|
|9|900|9000|9234.4321|92345678.99|str9|2020-01-09 01:00:00.123000|
|10|1000|10000|10234.4321|93345678.99|str10|2020-01-10 01:00:00.123000|
|11|110|1100|1334.4321|12445678.99|str11|2020-01-11 01:00:00.123000|
|12|210|2100|2334.4321|22445678.99|str21|2020-01-12 01:00:00.123000|
|13|310|3100|3334.4321|32445678.99|str31|2020-01-13 01:00:00.123000|
|14|410|4100|4334.4321|42445678.99|str41|2020-01-14 01:00:00.123000|
|15|510|5100|5334.4321|52445678.99|str51|2020-01-15 01:00:00.123000|
|16|610|6100|6334.4321|62445678.99|str61|2020-01-16 01:00:00.123000|
|17|710|7100|7334.4321|72445678.99|str71|2020-01-17 01:00:00.123000|
|18|810|8100|8334.4321|82445678.99|str81|2020-01-18 01:00:00.123000|
|19|910|9100|9334.4321|92445678.99|str91|2020-01-19 01:00:00.123000|
|20|1100|11000|10334.4321|93445678.99|str101|2020-01-20 01:00:00.123000|
20 rows returned
select col0, col1, col2, col3, col4, col5, col6 from test_mv_1 order by col0;
|col0|col1|col2|col3|col4|col5|col6|
|1|100|1000|1234.4321|12345678.99|str1|2020-01-01 01:00:00.123000|
|2|200|2000|2234.4321|22345678.99|str2|2020-01-02 01:00:00.123000|
|3|300|3000|3234.4321|32345678.99|str3|2020-01-03 01:00:00.123000|
|4|400|4000|4234.4321|42345678.99|str4|2020-01-04 01:00:00.123000|
|5|500|5000|5234.4321|52345678.99|str5|2020-01-05 01:00:00.123000|
|6|600|6000|6234.4321|62345678.99|str6|2020-01-06 01:00:00.123000|
|7|700|7000|7234.4321|72345678.99|str7|2020-01-07 01:00:00.123000|
|8|800|8000|8234.4321|82345678.99|str8|2020-01-08 01:00:00.123000|
|9|900|9000|9234.4321|92345678.99|str9|2020-01-09 01:00:00.123000|
|10|1000|10000|10234.4321|93345678.99|str10|2020-01-10 01:00:00.123000|
|11|110|1100|1334.4321|12445678.99|str11|2020-01-11 01:00:00.123000|
|12|210|2100|2334.4321|22445678.99|str21|2020-01-12 01:00:00.123000|
|13|310|3100|3334.4321|32445678.99|str31|2020-01-13 01:00:00.123000|
|14|410|4100|4334.4321|42445678.99|str41|2020-01-14 01:00:00.123000|
|15|510|5100|5334.4321|52445678.99|str51|2020-01-15 01:00:00.123000|
|16|610|6100|6334.4321|62445678.99|str61|2020-01-16 01:00:00.123000|
|17|710|7100|7334.4321|72445678.99|str71|2020-01-17 01:00:00.123000|
|18|810|8100|8334.4321|82445678.99|str81|2020-01-18 01:00:00.123000|
|19|910|9100|9334.4321|92445678.99|str91|2020-01-19 01:00:00.123000|
|20|1100|11000|10334.4321|93445678.99|str101|2020-01-20 01:00:00.123000|
20 rows returned

-- test with wildcard select;
create materialized view test_mv_2 as
select * from test_source_1
union all
select * from test_source_2;
0 rows returned

select * from test_mv_2 order by col0;
|col0|col1|col2|col3|col4|col5|col6|
|1|100|1000|1234.4321|12345678.99|str1|2020-01-01 01:00:00.123000|
|2|200|2000|2234.4321|22345678.99|str2|2020-01-02 01:00:00.123000|
|3|300|3000|3234.4321|32345678.99|str3|2020-01-03 01:00:00.123000|
|4|400|4000|4234.4321|42345678.99|str4|2020-01-04 01:00:00.123000|
|5|500|5000|5234.4321|52345678.99|str5|2020-01-05 01:00:00.123000|
|6|600|6000|6234.4321|62345678.99|str6|2020-01-06 01:00:00.123000|
|7|700|7000|7234.4321|72345678.99|str7|2020-01-07 01:00:00.123000|
|8|800|8000|8234.4321|82345678.99|str8|2020-01-08 01:00:00.123000|
|9|900|9000|9234.4321|92345678.99|str9|2020-01-09 01:00:00.123000|
|10|1000|10000|10234.4321|93345678.99|str10|2020-01-10 01:00:00.123000|
|11|110|1100|1334.4321|12445678.99|str11|2020-01-11 01:00:00.123000|
|12|210|2100|2334.4321|22445678.99|str21|2020-01-12 01:00:00.123000|
|13|310|3100|3334.4321|32445678.99|str31|2020-01-13 01:00:00.123000|
|14|410|4100|4334.4321|42445678.99|str41|2020-01-14 01:00:00.123000|
|15|510|5100|5334.4321|52445678.99|str51|2020-01-15 01:00:00.123000|
|16|610|6100|6334.4321|62445678.99|str61|2020-01-16 01:00:00.123000|
|17|710|7100|7334.4321|72445678.99|str71|2020-01-17 01:00:00.123000|
|18|810|8100|8334.4321|82445678.99|str81|2020-01-18 01:00:00.123000|
|19|910|9100|9334.4321|92445678.99|str91|2020-01-19 01:00:00.123000|
|20|1100|11000|10334.4321|93445678.99|str101|2020-01-20 01:00:00.123000|
20 rows returned
select col0, col1, col2, col3, col4, col5, col6 from test_mv_2 order by col0;
|col0|col1|col2|col3|col4|col5|col6|
|1|100|1000|1234.4321|12345678.99|str1|2020-01-01 01:00:00.123000|
|2|200|2000|2234.4321|22345678.99|str2|2020-01-02 01:00:00.123000|
|3|300|3000|3234.4321|32345678.99|str3|2020-01-03 01:00:00.123000|
|4|400|4000|4234.4321|42345678.99|str4|2020-01-04 01:00:00.123000|
|5|500|5000|5234.4321|52345678.99|str5|2020-01-05 01:00:00.123000|
|6|600|6000|6234.4321|62345678.99|str6|2020-01-06 01:00:00.123000|
|7|700|7000|7234.4321|72345678.99|str7|2020-01-07 01:00:00.123000|
|8|800|8000|8234.4321|82345678.99|str8|2020-01-08 01:00:00.123000|
|9|900|9000|9234.4321|92345678.99|str9|2020-01-09 01:00:00.123000|
|10|1000|10000|10234.4321|93345678.99|str10|2020-01-10 01:00:00.123000|
|11|110|1100|1334.4321|12445678.99|str11|2020-01-11 01:00:00.123000|
|12|210|2100|2334.4321|22445678.99|str21|2020-01-12 01:00:00.123000|
|13|310|3100|3334.4321|32445678.99|str31|2020-01-13 01:00:00.123000|
|14|410|4100|4334.4321|42445678.99|str41|2020-01-14 01:00:00.123000|
|15|510|5100|5334.4321|52445678.99|str51|2020-01-15 01:00:00.123000|
|16|610|6100|6334.4321|62445678.99|str61|2020-01-16 01:00:00.123000|
|17|710|7100|7334.4321|72445678.99|str71|2020-01-17 01:00:00.123000|
|18|810|8100|8334.4321|82445678.99|str81|2020-01-18 01:00:00.123000|
|19|910|9100|9334.4321|92445678.99|str91|2020-01-19 01:00:00.123000|
|20|1100|11000|10334.4321|93445678.99|str101|2020-01-20 01:00:00.123000|
20 rows returned

-- we test most of the combinations of casting between column types - the planner finds a common type that that both columns
-- can be cast into, e.g. if col1=double and col2=int then result=double

-- bigint and varchar cast;
create materialized view test_mv_3 as
select col0, col5 from test_source_1
union all
select col5, col0 from test_source_2;
0 rows returned

select * from test_mv_3 order by col0;
|col0|col5|
|1|str1|
|10|str10|
|2|str2|
|3|str3|
|4|str4|
|5|str5|
|6|str6|
|7|str7|
|8|str8|
|9|str9|
|str101|20|
|str11|11|
|str21|12|
|str31|13|
|str41|14|
|str51|15|
|str61|16|
|str71|17|
|str81|18|
|str91|19|
20 rows returned
select col0, col5 from test_mv_3 order by col0;
|col0|col5|
|1|str1|
|10|str10|
|2|str2|
|3|str3|
|4|str4|
|5|str5|
|6|str6|
|7|str7|
|8|str8|
|9|str9|
|str101|20|
|str11|11|
|str21|12|
|str31|13|
|str41|14|
|str51|15|
|str61|16|
|str71|17|
|str81|18|
|str91|19|
20 rows returned

-- bigint and decimal cast;
create materialized view test_mv_4 as
select col0, col4 from test_source_1
union all
select col4, col0 from test_source_2;
0 rows returned

select * from test_mv_4 order by col0;
|col0|col4|
|1.000000000000000000000000000000|12345678.990000000000000000000000000000|
|2.000000000000000000000000000000|22345678.990000000000000000000000000000|
|3.000000000000000000000000000000|32345678.990000000000000000000000000000|
|4.000000000000000000000000000000|42345678.990000000000000000000000000000|
|5.000000000000000000000000000000|52345678.990000000000000000000000000000|
|6.000000000000000000000000000000|62345678.990000000000000000000000000000|
|7.000000000000000000000000000000|72345678.990000000000000000000000000000|
|8.000000000000000000000000000000|82345678.990000000000000000000000000000|
|9.000000000000000000000000000000|92345678.990000000000000000000000000000|
|10.000000000000000000000000000000|93345678.990000000000000000000000000000|
|12445678.990000000000000000000000000000|11.000000000000000000000000000000|
|22445678.990000000000000000000000000000|12.000000000000000000000000000000|
|32445678.990000000000000000000000000000|13.000000000000000000000000000000|
|42445678.990000000000000000000000000000|14.000000000000000000000000000000|
|52445678.990000000000000000000000000000|15.000000000000000000000000000000|
|62445678.990000000000000000000000000000|16.000000000000000000000000000000|
|72445678.990000000000000000000000000000|17.000000000000000000000000000000|
|82445678.990000000000000000000000000000|18.000000000000000000000000000000|
|92445678.990000000000000000000000000000|19.000000000000000000000000000000|
|93445678.990000000000000000000000000000|20.000000000000000000000000000000|
20 rows returned
select col0, col4 from test_mv_4 order by col0;
|col0|col4|
|1.000000000000000000000000000000|12345678.990000000000000000000000000000|
|2.000000000000000000000000000000|22345678.990000000000000000000000000000|
|3.000000000000000000000000000000|32345678.990000000000000000000000000000|
|4.000000000000000000000000000000|42345678.990000000000000000000000000000|
|5.000000000000000000000000000000|52345678.990000000000000000000000000000|
|6.000000000000000000000000000000|62345678.990000000000000000000000000000|
|7.000000000000000000000000000000|72345678.990000000000000000000000000000|
|8.000000000000000000000000000000|82345678.990000000000000000000000000000|
|9.000000000000000000000000000000|92345678.990000000000000000000000000000|
|10.000000000000000000000000000000|93345678.990000000000000000000000000000|
|12445678.990000000000000000000000000000|11.000000000000000000000000000000|
|22445678.990000000000000000000000000000|12.000000000000000000000000000000|
|32445678.990000000000000000000000000000|13.000000000000000000000000000000|
|42445678.990000000000000000000000000000|14.000000000000000000000000000000|
|52445678.990000000000000000000000000000|15.000000000000000000000000000000|
|62445678.990000000000000000000000000000|16.000000000000000000000000000000|
|72445678.990000000000000000000000000000|17.000000000000000000000000000000|
|82445678.990000000000000000000000000000|18.000000000000000000000000000000|
|92445678.990000000000000000000000000000|19.000000000000000000000000000000|
|93445678.990000000000000000000000000000|20.000000000000000000000000000000|
20 rows returned

-- bigint and timestamp cast;
create materialized view test_mv_5 as
select col0, col6 from test_source_1
union all
select col6, col0 from test_source_2;
0 rows returned

select * from test_mv_5 order by col0;
|col0|col6|
|1|2020-01-01 01:00:00.123000|
|10|2020-01-10 01:00:00.123000|
|2|2020-01-02 01:00:00.123000|
|2020-01-11 01:00:00.123000|11|
|2020-01-12 01:00:00.123000|12|
|2020-01-13 01:00:00.123000|13|
|2020-01-14 01:00:00.123000|14|
|2020-01-15 01:00:00.123000|15|
|2020-01-16 01:00:00.123000|16|
|2020-01-17 01:00:00.123000|17|
|2020-01-18 01:00:00.123000|18|
|2020-01-19 01:00:00.123000|19|
|2020-01-20 01:00:00.123000|20|
|3|2020-01-03 01:00:00.123000|
|4|2020-01-04 01:00:00.123000|
|5|2020-01-05 01:00:00.123000|
|6|2020-01-06 01:00:00.123000|
|7|2020-01-07 01:00:00.123000|
|8|2020-01-08 01:00:00.123000|
|9|2020-01-09 01:00:00.123000|
20 rows returned
select col0, col6 from test_mv_5 order by col0;
|col0|col6|
|1|2020-01-01 01:00:00.123000|
|10|2020-01-10 01:00:00.123000|
|2|2020-01-02 01:00:00.123000|
|2020-01-11 01:00:00.123000|11|
|2020-01-12 01:00:00.123000|12|
|2020-01-13 01:00:00.123000|13|
|2020-01-14 01:00:00.123000|14|
|2020-01-15 01:00:00.123000|15|
|2020-01-16 01:00:00.123000|16|
|2020-01-17 01:00:00.123000|17|
|2020-01-18 01:00:00.123000|18|
|2020-01-19 01:00:00.123000|19|
|2020-01-20 01:00:00.123000|20|
|3|2020-01-03 01:00:00.123000|
|4|2020-01-04 01:00:00.123000|
|5|2020-01-05 01:00:00.123000|
|6|2020-01-06 01:00:00.123000|
|7|2020-01-07 01:00:00.123000|
|8|2020-01-08 01:00:00.123000|
|9|2020-01-09 01:00:00.123000|
20 rows returned

-- double and bigint cast;
create materialized view test_mv_6 as
select col3, col0 from test_source_1
union all
select col0, col3 from test_source_2;
0 rows returned

select * from test_mv_6 order by col3;
|col3|col0|
|11|1334.4321|
|12|2334.4321|
|13|3334.4321|
|14|4334.4321|
|15|5334.4321|
|16|6334.4321|
|17|7334.4321|
|18|8334.4321|
|19|9334.4321|
|20|10334.4321|
|1234.4321|1|
|2234.4321|2|
|3234.4321|3|
|4234.4321|4|
|5234.4321|5|
|6234.4321|6|
|7234.4321|7|
|8234.4321|8|
|9234.4321|9|
|10234.4321|10|
20 rows returned
select col3, col0 from test_mv_6 order by col3;
|col3|col0|
|11|1334.4321|
|12|2334.4321|
|13|3334.4321|
|14|4334.4321|
|15|5334.4321|
|16|6334.4321|
|17|7334.4321|
|18|8334.4321|
|19|9334.4321|
|20|10334.4321|
|1234.4321|1|
|2234.4321|2|
|3234.4321|3|
|4234.4321|4|
|5234.4321|5|
|6234.4321|6|
|7234.4321|7|
|8234.4321|8|
|9234.4321|9|
|10234.4321|10|
20 rows returned

-- double and varchar cast;
create materialized view test_mv_7 as
select col3, col5 from test_source_1
union all
select col5, col3 from test_source_2;
0 rows returned

select * from test_mv_7 order by col3;
|col3|col5|
|10234.4321|str10|
|1234.4321|str1|
|2234.4321|str2|
|3234.4321|str3|
|4234.4321|str4|
|5234.4321|str5|
|6234.4321|str6|
|7234.4321|str7|
|8234.4321|str8|
|9234.4321|str9|
|str101|10334.4321|
|str11|1334.4321|
|str21|2334.4321|
|str31|3334.4321|
|str41|4334.4321|
|str51|5334.4321|
|str61|6334.4321|
|str71|7334.4321|
|str81|8334.4321|
|str91|9334.4321|
20 rows returned
select col3, col5 from test_mv_7 order by col3;
|col3|col5|
|10234.4321|str10|
|1234.4321|str1|
|2234.4321|str2|
|3234.4321|str3|
|4234.4321|str4|
|5234.4321|str5|
|6234.4321|str6|
|7234.4321|str7|
|8234.4321|str8|
|9234.4321|str9|
|str101|10334.4321|
|str11|1334.4321|
|str21|2334.4321|
|str31|3334.4321|
|str41|4334.4321|
|str51|5334.4321|
|str61|6334.4321|
|str71|7334.4321|
|str81|8334.4321|
|str91|9334.4321|
20 rows returned

-- double and decimal cast;
create materialized view test_mv_8 as
select col3, col4 from test_source_1
union all
select col4, col3 from test_source_2;
0 rows returned

select * from test_mv_8 order by col3;
|col3|col4|
|1234.4321|1.234567899e+07|
|2234.4321|2.234567899e+07|
|3234.4321|3.234567899e+07|
|4234.4321|4.234567899e+07|
|5234.4321|5.234567899e+07|
|6234.4321|6.234567899e+07|
|7234.4321|7.234567899e+07|
|8234.4321|8.234567899e+07|
|9234.4321|9.234567899e+07|
|10234.4321|9.334567899e+07|
|1.244567899e+07|1334.4321|
|2.244567899e+07|2334.4321|
|3.244567899e+07|3334.4321|
|4.244567899e+07|4334.4321|
|5.244567899e+07|5334.4321|
|6.244567899e+07|6334.4321|
|7.244567899e+07|7334.4321|
|8.244567899e+07|8334.4321|
|9.244567899e+07|9334.4321|
|9.344567899e+07|10334.4321|
20 rows returned
select col3, col4 from test_mv_8 order by col3;
|col3|col4|
|1234.4321|1.234567899e+07|
|2234.4321|2.234567899e+07|
|3234.4321|3.234567899e+07|
|4234.4321|4.234567899e+07|
|5234.4321|5.234567899e+07|
|6234.4321|6.234567899e+07|
|7234.4321|7.234567899e+07|
|8234.4321|8.234567899e+07|
|9234.4321|9.234567899e+07|
|10234.4321|9.334567899e+07|
|1.244567899e+07|1334.4321|
|2.244567899e+07|2334.4321|
|3.244567899e+07|3334.4321|
|4.244567899e+07|4334.4321|
|5.244567899e+07|5334.4321|
|6.244567899e+07|6334.4321|
|7.244567899e+07|7334.4321|
|8.244567899e+07|8334.4321|
|9.244567899e+07|9334.4321|
|9.344567899e+07|10334.4321|
20 rows returned

-- double and timestamp cast;
create materialized view test_mv_9 as
select col3, col6 from test_source_1
union all
select col6, col3 from test_source_2;
0 rows returned

select * from test_mv_9 order by col3;
|col3|col6|
|10234.4321|2020-01-10 01:00:00.123000|
|1234.4321|2020-01-01 01:00:00.123000|
|2020-01-11 01:00:00.123000|1334.4321|
|2020-01-12 01:00:00.123000|2334.4321|
|2020-01-13 01:00:00.123000|3334.4321|
|2020-01-14 01:00:00.123000|4334.4321|
|2020-01-15 01:00:00.123000|5334.4321|
|2020-01-16 01:00:00.123000|6334.4321|
|2020-01-17 01:00:00.123000|7334.4321|
|2020-01-18 01:00:00.123000|8334.4321|
|2020-01-19 01:00:00.123000|9334.4321|
|2020-01-20 01:00:00.123000|10334.4321|
|2234.4321|2020-01-02 01:00:00.123000|
|3234.4321|2020-01-03 01:00:00.123000|
|4234.4321|2020-01-04 01:00:00.123000|
|5234.4321|2020-01-05 01:00:00.123000|
|6234.4321|2020-01-06 01:00:00.123000|
|7234.4321|2020-01-07 01:00:00.123000|
|8234.4321|2020-01-08 01:00:00.123000|
|9234.4321|2020-01-09 01:00:00.123000|
20 rows returned
select col3, col6 from test_mv_9 order by col3;
|col3|col6|
|10234.4321|2020-01-10 01:00:00.123000|
|1234.4321|2020-01-01 01:00:00.123000|
|2020-01-11 01:00:00.123000|1334.4321|
|2020-01-12 01:00:00.123000|2334.4321|
|2020-01-13 01:00:00.123000|3334.4321|
|2020-01-14 01:00:00.123000|4334.4321|
|2020-01-15 01:00:00.123000|5334.4321|
|2020-01-16 01:00:00.123000|6334.4321|
|2020-01-17 01:00:00.123000|7334.4321|
|2020-01-18 01:00:00.123000|8334.4321|
|2020-01-19 01:00:00.123000|9334.4321|
|2020-01-20 01:00:00.123000|10334.4321|
|2234.4321|2020-01-02 01:00:00.123000|
|3234.4321|2020-01-03 01:00:00.123000|
|4234.4321|2020-01-04 01:00:00.123000|
|5234.4321|2020-01-05 01:00:00.123000|
|6234.4321|2020-01-06 01:00:00.123000|
|7234.4321|2020-01-07 01:00:00.123000|
|8234.4321|2020-01-08 01:00:00.123000|
|9234.4321|2020-01-09 01:00:00.123000|
20 rows returned

-- varchar and decimal cast;
create materialized view test_mv_10 as
select col5, col4 from test_source_1
union all
select col4, col5 from test_source_2;
0 rows returned

select * from test_mv_10 order by col5;
|col5|col4|
|12445678.99|str11|
|22445678.99|str21|
|32445678.99|str31|
|42445678.99|str41|
|52445678.99|str51|
|62445678.99|str61|
|72445678.99|str71|
|82445678.99|str81|
|92445678.99|str91|
|93445678.99|str101|
|str1|12345678.99|
|str10|93345678.99|
|str2|22345678.99|
|str3|32345678.99|
|str4|42345678.99|
|str5|52345678.99|
|str6|62345678.99|
|str7|72345678.99|
|str8|82345678.99|
|str9|92345678.99|
20 rows returned
select col5, col4 from test_mv_10 order by col5;
|col5|col4|
|12445678.99|str11|
|22445678.99|str21|
|32445678.99|str31|
|42445678.99|str41|
|52445678.99|str51|
|62445678.99|str61|
|72445678.99|str71|
|82445678.99|str81|
|92445678.99|str91|
|93445678.99|str101|
|str1|12345678.99|
|str10|93345678.99|
|str2|22345678.99|
|str3|32345678.99|
|str4|42345678.99|
|str5|52345678.99|
|str6|62345678.99|
|str7|72345678.99|
|str8|82345678.99|
|str9|92345678.99|
20 rows returned

-- varchar and timestamp cast;
create materialized view test_mv_11 as
select col5, col6 from test_source_1
union all
select col6, col5 from test_source_2;
0 rows returned

select * from test_mv_11 order by col5;
|col5|col6|
|2020-01-11 01:00:00.123000|str11|
|2020-01-12 01:00:00.123000|str21|
|2020-01-13 01:00:00.123000|str31|
|2020-01-14 01:00:00.123000|str41|
|2020-01-15 01:00:00.123000|str51|
|2020-01-16 01:00:00.123000|str61|
|2020-01-17 01:00:00.123000|str71|
|2020-01-18 01:00:00.123000|str81|
|2020-01-19 01:00:00.123000|str91|
|2020-01-20 01:00:00.123000|str101|
|str1|2020-01-01 01:00:00.123000|
|str10|2020-01-10 01:00:00.123000|
|str2|2020-01-02 01:00:00.123000|
|str3|2020-01-03 01:00:00.123000|
|str4|2020-01-04 01:00:00.123000|
|str5|2020-01-05 01:00:00.123000|
|str6|2020-01-06 01:00:00.123000|
|str7|2020-01-07 01:00:00.123000|
|str8|2020-01-08 01:00:00.123000|
|str9|2020-01-09 01:00:00.123000|
20 rows returned
select col5, col6 from test_mv_11 order by col5;
|col5|col6|
|2020-01-11 01:00:00.123000|str11|
|2020-01-12 01:00:00.123000|str21|
|2020-01-13 01:00:00.123000|str31|
|2020-01-14 01:00:00.123000|str41|
|2020-01-15 01:00:00.123000|str51|
|2020-01-16 01:00:00.123000|str61|
|2020-01-17 01:00:00.123000|str71|
|2020-01-18 01:00:00.123000|str81|
|2020-01-19 01:00:00.123000|str91|
|2020-01-20 01:00:00.123000|str101|
|str1|2020-01-01 01:00:00.123000|
|str10|2020-01-10 01:00:00.123000|
|str2|2020-01-02 01:00:00.123000|
|str3|2020-01-03 01:00:00.123000|
|str4|2020-01-04 01:00:00.123000|
|str5|2020-01-05 01:00:00.123000|
|str6|2020-01-06 01:00:00.123000|
|str7|2020-01-07 01:00:00.123000|
|str8|2020-01-08 01:00:00.123000|
|str9|2020-01-09 01:00:00.123000|
20 rows returned

-- decimal and timestamp cast;
create materialized view test_mv_12 as
select col4, col6 from test_source_1
union all
select col6, col4 from test_source_2;
0 rows returned

select * from test_mv_12 order by col4;
|col4|col6|
|12345678.99|2020-01-01 01:00:00.123000|
|2020-01-11 01:00:00.123000|12445678.99|
|2020-01-12 01:00:00.123000|22445678.99|
|2020-01-13 01:00:00.123000|32445678.99|
|2020-01-14 01:00:00.123000|42445678.99|
|2020-01-15 01:00:00.123000|52445678.99|
|2020-01-16 01:00:00.123000|62445678.99|
|2020-01-17 01:00:00.123000|72445678.99|
|2020-01-18 01:00:00.123000|82445678.99|
|2020-01-19 01:00:00.123000|92445678.99|
|2020-01-20 01:00:00.123000|93445678.99|
|22345678.99|2020-01-02 01:00:00.123000|
|32345678.99|2020-01-03 01:00:00.123000|
|42345678.99|2020-01-04 01:00:00.123000|
|52345678.99|2020-01-05 01:00:00.123000|
|62345678.99|2020-01-06 01:00:00.123000|
|72345678.99|2020-01-07 01:00:00.123000|
|82345678.99|2020-01-08 01:00:00.123000|
|92345678.99|2020-01-09 01:00:00.123000|
|93345678.99|2020-01-10 01:00:00.123000|
20 rows returned
select col4, col6 from test_mv_12 order by col4;
|col4|col6|
|12345678.99|2020-01-01 01:00:00.123000|
|2020-01-11 01:00:00.123000|12445678.99|
|2020-01-12 01:00:00.123000|22445678.99|
|2020-01-13 01:00:00.123000|32445678.99|
|2020-01-14 01:00:00.123000|42445678.99|
|2020-01-15 01:00:00.123000|52445678.99|
|2020-01-16 01:00:00.123000|62445678.99|
|2020-01-17 01:00:00.123000|72445678.99|
|2020-01-18 01:00:00.123000|82445678.99|
|2020-01-19 01:00:00.123000|92445678.99|
|2020-01-20 01:00:00.123000|93445678.99|
|22345678.99|2020-01-02 01:00:00.123000|
|32345678.99|2020-01-03 01:00:00.123000|
|42345678.99|2020-01-04 01:00:00.123000|
|52345678.99|2020-01-05 01:00:00.123000|
|62345678.99|2020-01-06 01:00:00.123000|
|72345678.99|2020-01-07 01:00:00.123000|
|82345678.99|2020-01-08 01:00:00.123000|
|92345678.99|2020-01-09 01:00:00.123000|
|93345678.99|2020-01-10 01:00:00.123000|
20 rows returned

-- bigint and double cast;
create materialized view test_mv_13 as
select col0, col3 from test_source_1
union all
select col3, col0 from test_source_2;
0 rows returned

select * from test_mv_13 order by col0;
|col0|col3|
|1|1234.4321|
|2|2234.4321|
|3|3234.4321|
|4|4234.4321|
|5|5234.4321|
|6|6234.4321|
|7|7234.4321|
|8|8234.4321|
|9|9234.4321|
|10|10234.4321|
|1334.4321|11|
|2334.4321|12|
|3334.4321|13|
|4334.4321|14|
|5334.4321|15|
|6334.4321|16|
|7334.4321|17|
|8334.4321|18|
|9334.4321|19|
|10334.4321|20|
20 rows returned
select col0, col3 from test_mv_13 order by col0;
|col0|col3|
|1|1234.4321|
|2|2234.4321|
|3|3234.4321|
|4|4234.4321|
|5|5234.4321|
|6|6234.4321|
|7|7234.4321|
|8|8234.4321|
|9|9234.4321|
|10|10234.4321|
|1334.4321|11|
|2334.4321|12|
|3334.4321|13|
|4334.4321|14|
|5334.4321|15|
|6334.4321|16|
|7334.4321|17|
|8334.4321|18|
|9334.4321|19|
|10334.4321|20|
20 rows returned

drop materialized view test_mv_13;
0 rows returned
drop materialized view test_mv_12;
0 rows returned
drop materialized view test_mv_11;
0 rows returned
drop materialized view test_mv_10;
0 rows returned
drop materialized view test_mv_9;
0 rows returned
drop materialized view test_mv_8;
0 rows returned
drop materialized view test_mv_7;
0 rows returned
drop materialized view test_mv_6;
0 rows returned
drop materialized view test_mv_5;
0 rows returned
drop materialized view test_mv_4;
0 rows returned
drop materialized view test_mv_3;
0 rows returned
drop materialized view test_mv_2;
0 rows returned
drop materialized view test_mv_1;
0 rows returned
drop source test_source_2;
0 rows returned
drop source test_source_1;
0 rows returned

--delete topic testtopic2;
--delete topic testtopic1;