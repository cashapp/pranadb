--create topic sensor_readings;
use test;
create source latest_sensor_readings(
    sensor_id bigint,
    country varchar,
    city varchar,
    reading_1 bigint,
    reading_2 double,
    reading_3 decimal(10,2),
    primary key (sensor_id)
) with (
    brokername = "testbroker",
    topicname = "sensor_readings",
    headerencoding = "json",
    keyencoding = "json",
    valueencoding = "json",
    columnselectors = (
        "k.k0",
        "v.v1",
        "v.v2",
        "v.v3",
        "v.v4",
        "v.v5"
    )
);

--load data dataset_1;

select * from latest_sensor_readings order by sensor_id;

-- SUM;
-- ===;

-- No group by;

create materialized view test_mv_1 as select sum(reading_1) from latest_sensor_readings;
select * from test_mv_1;

drop materialized view test_mv_1;
drop source latest_sensor_readings;

--delete topic sensor_readings;