--create topic testtopic;
use test;
0 rows returned
create source test_source_1(
    col0 bigint,
    col1 tinyint,
    col2 int,
    col3 double,
    col4 decimal(10, 2),
    col5 varchar,
    col6 timestamp(6),
    col7 timestamp,
    primary key (col0)
) with (
    brokername = "testbroker",
    topicname = "testtopic",
    headerencoding = "json",
    keyencoding = "json",
    valueencoding = "json",
    columnselectors = (
        meta("key").k0,
        v1,
        v2,
        v3,
        v4,
        v5,
        v6,
        v7
    )
);
0 rows returned

--load data dataset_1;

set max_line_width 300;
0 rows returned

select * from test_source_1 order by col0;
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| col0                 | col1 | col2        | col3                                                           | col4                                                           | col5                                                           | col6                       | col7                       |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 1                    | 10   | 1000        | 1234.4321                                                      | 12345678.99                                                    | str1                                                           | 2020-01-01 01:00:00.123450 | 2020-01-01 01:01:00.000000 |
| 2                    | 20   | 2000        | 2234.4321                                                      | 22345678.99                                                    | str2                                                           | 2020-01-02 01:00:00.123451 | 2020-01-02 01:01:00.000000 |
| 3                    | 30   | 3000        | 3234.4321                                                      | 32345678.99                                                    | str3                                                           | 2020-01-03 03:00:00.123452 | 2020-01-03 03:02:00.000000 |
| 4                    | 40   | 4000        | 4234.4321                                                      | 42345678.99                                                    | str4                                                           | 2020-01-04 04:00:00.123453 | 2020-01-04 04:03:00.000000 |
| 5                    | 50   | 5000        | 5234.4321                                                      | 52345678.99                                                    | str5                                                           | 2020-01-05 05:00:00.123454 | 2020-01-05 05:04:00.000000 |
| 6                    | 60   | 6000        | 6234.4321                                                      | 62345678.99                                                    | str6                                                           | 2020-01-06 06:00:00.123455 | 2020-01-06 06:05:00.000000 |
| 7                    | 70   | 7000        | 7234.4321                                                      | 72345678.99                                                    | str7                                                           | 2020-01-07 07:00:00.123456 | 2020-01-07 07:06:00.000000 |
| 8                    | 80   | 8000        | 8234.4321                                                      | 82345678.99                                                    | str8                                                           | 2020-01-08 08:00:00.123457 | 2020-01-08 08:07:00.000000 |
| 9                    | 90   | 9000        | 9234.4321                                                      | 92345678.99                                                    | str9                                                           | 2020-01-09 09:00:00.123458 | 2020-01-09 09:08:00.000000 |
| 10                   | 100  | 10000       | 10234.4321                                                     | 93345678.99                                                    | str10                                                          | 2020-10-10 01:00:00.123459 | 2020-10-10 01:09:00.000000 |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
10 rows returned

-- simple verification that we can create an MV using casted columns;
create materialized view mv1 as select
cast(col0 as char) as c0,
cast(col1 as char) as c1,
cast(col2 as char) as c2,
cast(col3 as char) as c3,
cast(col4 as char) as c4,
cast(col5 as char) as c5,
cast(col6 as char) as c6,
cast(col7 as char) as c7,
cast(null as char) as c8,
cast(null as signed) as c9,
cast(null as signed) as c10,
cast(null as decimal(20,4)) as c11
from test_source_1;
0 rows returned

describe mv1;
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| field                                                                                            | type                                                                                             | key                                                                                              |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| c0                                                                                               | varchar                                                                                          |                                                                                                  |
| c1                                                                                               | varchar                                                                                          |                                                                                                  |
| c2                                                                                               | varchar                                                                                          |                                                                                                  |
| c3                                                                                               | varchar                                                                                          |                                                                                                  |
| c4                                                                                               | varchar                                                                                          |                                                                                                  |
| c5                                                                                               | varchar                                                                                          |                                                                                                  |
| c6                                                                                               | varchar                                                                                          |                                                                                                  |
| c7                                                                                               | varchar                                                                                          |                                                                                                  |
| c8                                                                                               | varchar                                                                                          |                                                                                                  |
| c9                                                                                               | bigint                                                                                           |                                                                                                  |
| c10                                                                                              | bigint                                                                                           |                                                                                                  |
| c11                                                                                              | decimal(20, 4)                                                                                   |                                                                                                  |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
12 rows returned

select * from mv1 order by c0;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| c0                     | c1                     | c2                     | c3                     | c4                     | c5                     | c6                     | c7                     | c8                     | c9                   | c10                  | c11                    |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 1                      | 10                     | 1000                   | 1234.4321              | 12345678.99            | str1                   | 2020-01-01 01:00:00... | 2020-01-01 01:01:00    | null                   | null                 | null                 | null                   |
| 10                     | 100                    | 10000                  | 10234.4321             | 93345678.99            | str10                  | 2020-10-10 01:00:00... | 2020-10-10 01:09:00    | null                   | null                 | null                 | null                   |
| 2                      | 20                     | 2000                   | 2234.4321              | 22345678.99            | str2                   | 2020-01-02 01:00:00... | 2020-01-02 01:01:00    | null                   | null                 | null                 | null                   |
| 3                      | 30                     | 3000                   | 3234.4321              | 32345678.99            | str3                   | 2020-01-03 03:00:00... | 2020-01-03 03:02:00    | null                   | null                 | null                 | null                   |
| 4                      | 40                     | 4000                   | 4234.4321              | 42345678.99            | str4                   | 2020-01-04 04:00:00... | 2020-01-04 04:03:00    | null                   | null                 | null                 | null                   |
| 5                      | 50                     | 5000                   | 5234.4321              | 52345678.99            | str5                   | 2020-01-05 05:00:00... | 2020-01-05 05:04:00    | null                   | null                 | null                 | null                   |
| 6                      | 60                     | 6000                   | 6234.4321              | 62345678.99            | str6                   | 2020-01-06 06:00:00... | 2020-01-06 06:05:00    | null                   | null                 | null                 | null                   |
| 7                      | 70                     | 7000                   | 7234.4321              | 72345678.99            | str7                   | 2020-01-07 07:00:00... | 2020-01-07 07:06:00    | null                   | null                 | null                 | null                   |
| 8                      | 80                     | 8000                   | 8234.4321              | 82345678.99            | str8                   | 2020-01-08 08:00:00... | 2020-01-08 08:07:00    | null                   | null                 | null                 | null                   |
| 9                      | 90                     | 9000                   | 9234.4321              | 92345678.99            | str9                   | 2020-01-09 09:00:00... | 2020-01-09 09:08:00    | null                   | null                 | null                 | null                   |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
10 rows returned

drop materialized view mv1;
0 rows returned
drop source test_source_1;
0 rows returned


-- test all combinations of cast we support;

--create topic testtopic2;
create source dummy(
    col0 bigint,
    col1 tinyint,
    col2 int,
    col3 double,
    col4 decimal(10, 2),
    col5 varchar,
    col6 varchar,
    col7 timestamp(6),
    col8 timestamp,
    primary key (col0)
) with (
    brokername = "testbroker",
    topicname = "testtopic2",
    headerencoding = "json",
    keyencoding = "json",
    valueencoding = "json",
    columnselectors = (
        meta("key").k0,
        v1,
        v2,
        v3,
        v4,
        v5,
        v6,
        v7,
        v8
    )
);
0 rows returned

--load data dataset_3;

-- cast to char;

create materialized view mv_1 as select cast(col0 as char) from dummy;
0 rows returned
describe mv_1;
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| field                                                                                            | type                                                                                             | key                                                                                              |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| cast(col0 as char)                                                                               | varchar                                                                                          |                                                                                                  |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from mv_1;
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| cast(col0 as char)                                                                                                                                                                                                                                                                                       |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| -1                                                                                                                                                                                                                                                                                                       |
| 1                                                                                                                                                                                                                                                                                                        |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
2 rows returned

create materialized view mv_2 as select cast(col1 as char) from dummy;
0 rows returned
describe mv_2;
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| field                                                                                            | type                                                                                             | key                                                                                              |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| cast(col1 as char)                                                                               | varchar                                                                                          |                                                                                                  |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from mv_2;
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| cast(col1 as char)                                                                                                                                                                                                                                                                                       |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| -10                                                                                                                                                                                                                                                                                                      |
| 10                                                                                                                                                                                                                                                                                                       |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
2 rows returned

create materialized view mv_3 as select cast(col2 as char) from dummy;
0 rows returned
describe mv_3;
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| field                                                                                            | type                                                                                             | key                                                                                              |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| cast(col2 as char)                                                                               | varchar                                                                                          |                                                                                                  |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from mv_3;
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| cast(col2 as char)                                                                                                                                                                                                                                                                                       |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| -1000                                                                                                                                                                                                                                                                                                    |
| 1000                                                                                                                                                                                                                                                                                                     |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
2 rows returned

create materialized view mv_4 as select cast(col3 as char) from dummy;
0 rows returned
describe mv_4;
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| field                                                                                            | type                                                                                             | key                                                                                              |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| cast(col3 as char)                                                                               | varchar                                                                                          |                                                                                                  |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from mv_4;
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| cast(col3 as char)                                                                                                                                                                                                                                                                                       |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| -1234.4321                                                                                                                                                                                                                                                                                               |
| 1234.4321                                                                                                                                                                                                                                                                                                |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
2 rows returned

create materialized view mv_5 as select cast(col4 as char) from dummy;
0 rows returned
describe mv_5;
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| field                                                                                            | type                                                                                             | key                                                                                              |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| cast(col4 as char)                                                                               | varchar                                                                                          |                                                                                                  |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from mv_5;
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| cast(col4 as char)                                                                                                                                                                                                                                                                                       |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 12345678.99                                                                                                                                                                                                                                                                                              |
| 12345678.99                                                                                                                                                                                                                                                                                              |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
2 rows returned

create materialized view mv_6 as select cast(col5 as char) from dummy;
0 rows returned
describe mv_6;
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| field                                                                                            | type                                                                                             | key                                                                                              |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| cast(col5 as char)                                                                               | varchar                                                                                          |                                                                                                  |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from mv_6;
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| cast(col5 as char)                                                                                                                                                                                                                                                                                       |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| -1234                                                                                                                                                                                                                                                                                                    |
| 1234                                                                                                                                                                                                                                                                                                     |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
2 rows returned

create materialized view mv_7 as select cast(col6 as char) from dummy;
0 rows returned
describe mv_7;
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| field                                                                                            | type                                                                                             | key                                                                                              |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| cast(col6 as char)                                                                               | varchar                                                                                          |                                                                                                  |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from mv_7;
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| cast(col6 as char)                                                                                                                                                                                                                                                                                       |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 2027-04-05 06:32:21.575656                                                                                                                                                                                                                                                                               |
| 2027-04-05 06:32:21.575656                                                                                                                                                                                                                                                                               |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
2 rows returned

create materialized view mv_8 as select cast(col7 as char) from dummy;
0 rows returned
describe mv_8;
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| field                                                                                            | type                                                                                             | key                                                                                              |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| cast(col7 as char)                                                                               | varchar                                                                                          |                                                                                                  |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from mv_8;
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| cast(col7 as char)                                                                                                                                                                                                                                                                                       |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 2020-01-01 01:00:00.123456                                                                                                                                                                                                                                                                               |
| 2020-01-01 01:00:00.123456                                                                                                                                                                                                                                                                               |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
2 rows returned

create materialized view mv_9 as select cast(col8 as char) from dummy;
0 rows returned
describe mv_9;
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| field                                                                                            | type                                                                                             | key                                                                                              |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| cast(col8 as char)                                                                               | varchar                                                                                          |                                                                                                  |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from mv_9;
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| cast(col8 as char)                                                                                                                                                                                                                                                                                       |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 2020-01-01 01:01:00                                                                                                                                                                                                                                                                                      |
| 2020-01-01 01:01:00                                                                                                                                                                                                                                                                                      |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
2 rows returned

drop materialized view mv_9;
0 rows returned
drop materialized view mv_8;
0 rows returned
drop materialized view mv_7;
0 rows returned
drop materialized view mv_6;
0 rows returned
drop materialized view mv_5;
0 rows returned
drop materialized view mv_4;
0 rows returned
drop materialized view mv_3;
0 rows returned
drop materialized view mv_2;
0 rows returned
drop materialized view mv_1;
0 rows returned

-- cast to signed;

create materialized view mv_1 as select cast(col0 as signed) from dummy;
0 rows returned
describe mv_1;
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| field                                                                                            | type                                                                                             | key                                                                                              |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| cast(col0 as signed)                                                                             | bigint                                                                                           |                                                                                                  |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from mv_1;
+----------------------+
| cast(col0 as signed) |
+----------------------+
| -1                   |
| 1                    |
+----------------------+
2 rows returned

create materialized view mv_2 as select cast(col1 as signed) from dummy;
0 rows returned
describe mv_2;
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| field                                                                                            | type                                                                                             | key                                                                                              |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| cast(col1 as signed)                                                                             | bigint                                                                                           |                                                                                                  |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from mv_2;
+----------------------+
| cast(col1 as signed) |
+----------------------+
| -10                  |
| 10                   |
+----------------------+
2 rows returned

create materialized view mv_3 as select cast(col2 as signed) from dummy;
0 rows returned
describe mv_3;
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| field                                                                                            | type                                                                                             | key                                                                                              |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| cast(col2 as signed)                                                                             | bigint                                                                                           |                                                                                                  |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from mv_3;
+----------------------+
| cast(col2 as signed) |
+----------------------+
| -1000                |
| 1000                 |
+----------------------+
2 rows returned

create materialized view mv_4 as select cast(col3 as signed) from dummy;
0 rows returned
describe mv_4;
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| field                                                                                            | type                                                                                             | key                                                                                              |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| cast(col3 as signed)                                                                             | bigint                                                                                           |                                                                                                  |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from mv_4;
+----------------------+
| cast(col3 as signed) |
+----------------------+
| -1234                |
| 1234                 |
+----------------------+
2 rows returned

create materialized view mv_5 as select cast(col4 as signed) from dummy;
0 rows returned
describe mv_5;
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| field                                                                                            | type                                                                                             | key                                                                                              |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| cast(col4 as signed)                                                                             | bigint                                                                                           |                                                                                                  |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from mv_5;
+----------------------+
| cast(col4 as signed) |
+----------------------+
| 12345679             |
| 12345679             |
+----------------------+
2 rows returned

create materialized view mv_6 as select cast(col5 as signed) from dummy;
0 rows returned
describe mv_6;
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| field                                                                                            | type                                                                                             | key                                                                                              |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| cast(col5 as signed)                                                                             | bigint                                                                                           |                                                                                                  |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from mv_6;
+----------------------+
| cast(col5 as signed) |
+----------------------+
| -1234                |
| 1234                 |
+----------------------+
2 rows returned

create materialized view mv_8 as select cast(col7 as signed) from dummy;
0 rows returned
describe mv_8;
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| field                                                                                            | type                                                                                             | key                                                                                              |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| cast(col7 as signed)                                                                             | bigint                                                                                           |                                                                                                  |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from mv_8;
+----------------------+
| cast(col7 as signed) |
+----------------------+
| 20200101010000       |
| 20200101010000       |
+----------------------+
2 rows returned

create materialized view mv_9 as select cast(col8 as signed) from dummy;
0 rows returned
describe mv_9;
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| field                                                                                            | type                                                                                             | key                                                                                              |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| cast(col8 as signed)                                                                             | bigint                                                                                           |                                                                                                  |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from mv_9;
+----------------------+
| cast(col8 as signed) |
+----------------------+
| 20200101010100       |
| 20200101010100       |
+----------------------+
2 rows returned

drop materialized view mv_9;
0 rows returned
drop materialized view mv_8;
0 rows returned
drop materialized view mv_6;
0 rows returned
drop materialized view mv_5;
0 rows returned
drop materialized view mv_4;
0 rows returned
drop materialized view mv_3;
0 rows returned
drop materialized view mv_2;
0 rows returned
drop materialized view mv_1;
0 rows returned

-- cast to decimal;

create materialized view mv_1 as select cast(col0 as decimal(20,4)) from dummy;
0 rows returned
describe mv_1;
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| field                                                                                            | type                                                                                             | key                                                                                              |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| cast(col0 as decimal(20,4))                                                                      | decimal(20, 4)                                                                                   |                                                                                                  |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from mv_1;
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| cast(col0 as decimal(20,4))                                                                                                                                                                                                                                                                              |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| -1.0000                                                                                                                                                                                                                                                                                                  |
| 1.0000                                                                                                                                                                                                                                                                                                   |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
2 rows returned

create materialized view mv_2 as select cast(col1 as decimal(20,4)) from dummy;
0 rows returned
describe mv_2;
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| field                                                                                            | type                                                                                             | key                                                                                              |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| cast(col1 as decimal(20,4))                                                                      | decimal(20, 4)                                                                                   |                                                                                                  |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from mv_2;
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| cast(col1 as decimal(20,4))                                                                                                                                                                                                                                                                              |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| -10.0000                                                                                                                                                                                                                                                                                                 |
| 10.0000                                                                                                                                                                                                                                                                                                  |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
2 rows returned

create materialized view mv_3 as select cast(col2 as decimal(20,4)) from dummy;
0 rows returned
describe mv_3;
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| field                                                                                            | type                                                                                             | key                                                                                              |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| cast(col2 as decimal(20,4))                                                                      | decimal(20, 4)                                                                                   |                                                                                                  |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from mv_3;
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| cast(col2 as decimal(20,4))                                                                                                                                                                                                                                                                              |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| -1000.0000                                                                                                                                                                                                                                                                                               |
| 1000.0000                                                                                                                                                                                                                                                                                                |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
2 rows returned

create materialized view mv_4 as select cast(col3 as decimal(20,4)) from dummy;
0 rows returned
describe mv_4;
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| field                                                                                            | type                                                                                             | key                                                                                              |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| cast(col3 as decimal(20,4))                                                                      | decimal(20, 4)                                                                                   |                                                                                                  |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from mv_4;
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| cast(col3 as decimal(20,4))                                                                                                                                                                                                                                                                              |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| -1234.4321                                                                                                                                                                                                                                                                                               |
| 1234.4321                                                                                                                                                                                                                                                                                                |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
2 rows returned

create materialized view mv_5 as select cast(col4 as decimal(20,4)) from dummy;
0 rows returned
describe mv_5;
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| field                                                                                            | type                                                                                             | key                                                                                              |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| cast(col4 as decimal(20,4))                                                                      | decimal(20, 4)                                                                                   |                                                                                                  |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from mv_5;
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| cast(col4 as decimal(20,4))                                                                                                                                                                                                                                                                              |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 12345678.9900                                                                                                                                                                                                                                                                                            |
| 12345678.9900                                                                                                                                                                                                                                                                                            |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
2 rows returned

create materialized view mv_6 as select cast(col5 as decimal(20,4)) from dummy;
0 rows returned
describe mv_6;
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| field                                                                                            | type                                                                                             | key                                                                                              |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| cast(col5 as decimal(20,4))                                                                      | decimal(20, 4)                                                                                   |                                                                                                  |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from mv_6;
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| cast(col5 as decimal(20,4))                                                                                                                                                                                                                                                                              |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| -1234.0000                                                                                                                                                                                                                                                                                               |
| 1234.0000                                                                                                                                                                                                                                                                                                |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
2 rows returned

create materialized view mv_8 as select cast(col7 as decimal(20,4)) from dummy;
0 rows returned
describe mv_8;
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| field                                                                                            | type                                                                                             | key                                                                                              |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| cast(col7 as decimal(20,4))                                                                      | decimal(20, 4)                                                                                   |                                                                                                  |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from mv_8;
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| cast(col7 as decimal(20,4))                                                                                                                                                                                                                                                                              |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 20200101010000.1235                                                                                                                                                                                                                                                                                      |
| 20200101010000.1235                                                                                                                                                                                                                                                                                      |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
2 rows returned

create materialized view mv_9 as select cast(col8 as decimal(20,4)) from dummy;
0 rows returned
describe mv_9;
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| field                                                                                            | type                                                                                             | key                                                                                              |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| cast(col8 as decimal(20,4))                                                                      | decimal(20, 4)                                                                                   |                                                                                                  |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from mv_9;
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| cast(col8 as decimal(20,4))                                                                                                                                                                                                                                                                              |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 20200101010100.0000                                                                                                                                                                                                                                                                                      |
| 20200101010100.0000                                                                                                                                                                                                                                                                                      |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
2 rows returned

drop materialized view mv_9;
0 rows returned
drop materialized view mv_8;
0 rows returned
drop materialized view mv_6;
0 rows returned
drop materialized view mv_5;
0 rows returned
drop materialized view mv_4;
0 rows returned
drop materialized view mv_3;
0 rows returned
drop materialized view mv_2;
0 rows returned
drop materialized view mv_1;
0 rows returned


drop source dummy;
0 rows returned

--delete topic testtopic2;
--delete topic testtopic;
