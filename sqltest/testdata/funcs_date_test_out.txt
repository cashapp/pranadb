--local only;
-- This tests all the date/time functions we provide;
--create topic testtopic;
use test;
0 rows returned
create source test_source_1(
    col0 bigint,
    col1 timestamp(6),
    primary key (col0)
) with (
    brokername = "testbroker",
    topicname = "testtopic",
    headerencoding = "json",
    keyencoding = "json",
    valueencoding = "json",
    columnselectors = (
        meta("key").k0,
        v1
    )
);
0 rows returned

--load data dataset_1;

-- YEAR, MONTH, DAYOFMONTH, HOUR, MINUTE, SECOND, MICROSECOND;

select col0, year(col1), month(col1), day(col1), hour(col1), minute(col1), second(col1), microsecond(col1) from test_source_1 order by col0;
|col0|year(col1)|month(col1)|day(col1)|hour(col1)|minute(col1)|second(col1)|microsecond(col1)|
|1|2020|1|1|0|0|0|123456|
|2|2020|3|1|1|11|0|654321|
|3|2020|11|24|10|45|34|745343|
|4|2021|7|15|17|18|54|575654|
|5|1987|12|24|21|25|27|676733|
|6|2036|6|30|6|3|9|1|
6 rows returned

-- DATE FORMAT;

select col0, date_format(col1, '%H:%i:%s::%f %d/%m/%y') from test_source_1 order by col0;
|col0|date_format(col1, '%h:%i:%s::%f %d/%m/%y')|
|1|00:00:00::123456 01/01/20|
|2|01:11:00::654321 01/03/20|
|3|10:45:34::745343 24/11/20|
|4|17:18:54::575654 15/07/21|
|5|21:25:27::676733 24/12/87|
|6|06:03:09::000001 30/06/36|
6 rows returned

-- UNIX_TIMESTAMP;

select col0, unix_timestamp(col1) from test_source_1 order by col0;
|col0|unix_timestamp(col1)|
|1|1577836800.123456|
|2|1583025060.654321|
|3|1606214734.745343|
|4|1626369534.575654|
|5|567379527.676733|
|6|2098418589.000001|
6 rows returned

select col0, unix_timestamp(from_unixtime(1606214734.745343)), unix_timestamp(from_unixtime(1577836800)) from test_source_1 order by col0;
|col0|unix_timestamp(from_unixtime(1606214734.745343))|unix_timestamp(from_unixtime(1577836800))|
|1|1606214734.745343|1577836800|
|2|1606214734.745343|1577836800|
|3|1606214734.745343|1577836800|
|4|1606214734.745343|1577836800|
|5|1606214734.745343|1577836800|
|6|1606214734.745343|1577836800|
6 rows returned

drop source test_source_1;
0 rows returned

--delete topic testtopic;
;
