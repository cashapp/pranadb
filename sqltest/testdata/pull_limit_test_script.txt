--create topic testtopic;
use test;
create source test_source_1(
    col0 bigint,
    primary key (col0)
) with (
    brokername = "testbroker",
    topicname = "testtopic",
    headerencoding = "json",
    keyencoding = "json",
    valueencoding = "json",
    columnselectors = (
        meta("key").k0
    )
);

create materialized view test_mv_1 as select * from test_source_1;

--load data dataset_1;

--test with source;

select * from test_source_1 limit 300;
select * from test_source_1 limit 1;
select * from test_source_1 limit 5;
select * from test_source_1 limit 10;
select * from test_source_1 limit 20;
select * from test_source_1 limit 40;

select * from test_source_1 limit 0, 10;
select * from test_source_1 limit 5, 5;
select * from test_source_1 limit 5 offset 5;
select * from test_source_1 limit 300, 5;

--test with mv;

select * from test_mv_1 limit 300;
select * from test_mv_1 limit 1;
select * from test_mv_1 limit 5;
select * from test_mv_1 limit 10;
select * from test_mv_1 limit 20;
select * from test_mv_1 limit 40;

select * from test_mv_1 limit 0, 10;
select * from test_mv_1 limit 5, 5;
select * from test_mv_1 limit 5 offset 5;
select * from test_mv_1 limit 300, 5;


drop materialized view test_mv_1;

drop source test_source_1;

--delete topic testtopic;